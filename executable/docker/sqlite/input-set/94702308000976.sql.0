PRAGMA cache_size = -2000;
;CREATE TABLE t1(a, b, c);
;WITH r(i) AS (
    SELECT 1 UNION ALL SELECT i+1 FROM r WHERE i<100000
  )
  INSERT INTO t1 SELECT randomblob(100),randomblob(100),randomblob(100) FROM r;
;CREATE INDEX t1a ON t1(a);
;CREATE INDEX t1b ON t1(b);
;CREATE INDEX t1c ON t1(c);
;
;VACUUM
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t1(a, b, c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;CREATE INDEX t1a ON t1(a)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='t1a' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='t1a' AND type='index' ORDER BY rowid
;CREATE INDEX t1b ON t1(b)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='t1b' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='t1b' AND type='index' ORDER BY rowid
;CREATE INDEX t1c ON t1(c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='t1c' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='t1c' AND type='index' ORDER BY rowid
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t1' SELECT*FROM"main".'t1'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;SELECT count(*) FROM t1 WHERE +a IS NOT NULL

;