BEGIN;
;CREATE TABLE t1(a INTEGER PRIMARY KEY, b, c);
;INSERT INTO t1 VALUES(NULL,randstr(10,100),randstr(5,50));
;INSERT INTO t1 VALUES(123456,randstr(10,100),randstr(5,50));
;INSERT INTO t1 SELECT NULL, b||'-'||rowid, c||'-'||rowid FROM t1;
;CREATE INDEX i1 ON t1(b,c);
;CREATE UNIQUE INDEX i2 ON t1(c,a);
;CREATE TABLE t2 AS SELECT * FROM t1;
;COMMIT;
;DROP TABLE t2;
;
;SELECT name, type, sql FROM sqlite_master order by name
  
;SELECT name FROM sqlite_master WHERE type='table' order by name
  
;SELECT * FROM t1
;PRAGMA default_synchronous
;PRAGMA default_cache_size
;SELECT substr(name,1,3) FROM sqlite_master
;VACUUM;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t1(a INTEGER PRIMARY KEY, b, c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;CREATE INDEX i1 ON t1(b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;CREATE UNIQUE INDEX i2 ON t1(c,a)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t1' SELECT*FROM"main".'t1'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;
;SELECT name, type, sql FROM sqlite_master order by name
  
;SELECT name FROM sqlite_master WHERE type='table' order by name
  
;SELECT * FROM t1
;PRAGMA default_synchronous
;PRAGMA default_cache_size
;BEGIN;
;CREATE TABLE t2 AS SELECT * FROM t1;
;CREATE TABLE t3 AS SELECT * FROM t1;
;CREATE VIEW v1 AS SELECT b, c FROM t3;
;CREATE TRIGGER r1 AFTER DELETE ON t2 BEGIN SELECT 1; END;
;COMMIT;
;DROP TABLE t2;
;
;SELECT name, type, sql FROM sqlite_master order by name
  
;SELECT name FROM sqlite_master WHERE type='table' order by name
  
;SELECT * FROM t1
;SELECT * FROM t3
;PRAGMA default_synchronous
;PRAGMA default_cache_size
;VACUUM;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t1(a INTEGER PRIMARY KEY, b, c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;CREATE TABLE t3(a INT,b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;CREATE INDEX i1 ON t1(b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;CREATE UNIQUE INDEX i2 ON t1(c,a)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t1' SELECT*FROM"main".'t1'
;INSERT INTO vacuum_db.'t3' SELECT*FROM"main".'t3'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;
;SELECT name, type, sql FROM sqlite_master order by name
  
;SELECT name FROM sqlite_master WHERE type='table' order by name
  
;SELECT * FROM t1
;SELECT * FROM t3
;PRAGMA default_synchronous
;PRAGMA default_cache_size
;BEGIN;
;VACUUM;
;COMMIT
;VACUUM
  
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t1(a INTEGER PRIMARY KEY, b, c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;CREATE TABLE t3(a INT,b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;CREATE INDEX i1 ON t1(b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;CREATE UNIQUE INDEX i2 ON t1(c,a)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t1' SELECT*FROM"main".'t1'
;INSERT INTO vacuum_db.'t3' SELECT*FROM"main".'t3'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;SELECT name, type, sql FROM sqlite_master order by name
  
;SELECT name FROM sqlite_master WHERE type='table' order by name
  
;SELECT * FROM t1
;SELECT * FROM t3
;PRAGMA default_synchronous
;PRAGMA default_cache_size
;BEGIN;
;CREATE TABLE t6 AS SELECT * FROM t1;
;CREATE TABLE t7 AS SELECT * FROM t1;
;COMMIT;
;
;VACUUM;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t1(a INTEGER PRIMARY KEY, b, c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;CREATE TABLE t3(a INT,b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;CREATE TABLE t6(a INT,b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t6' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t6' AND type!='trigger' ORDER BY rowid
;CREATE TABLE t7(a INT,b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t7' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t7' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;CREATE INDEX i1 ON t1(b,c)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i1' AND type='index' ORDER BY rowid
;CREATE UNIQUE INDEX i2 ON t1(c,a)
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE name='i2' AND type='index' ORDER BY rowid
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t1' SELECT*FROM"main".'t1'
;INSERT INTO vacuum_db.'t3' SELECT*FROM"main".'t3'
;INSERT INTO vacuum_db.'t6' SELECT*FROM"main".'t6'
;INSERT INTO vacuum_db.'t7' SELECT*FROM"main".'t7'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;
;SELECT * FROM t7 WHERE a=1234567890
  
;PRAGMA integrity_check
;INSERT INTO t7 SELECT * FROM t6;
;SELECT count(*) FROM t7;
;
;