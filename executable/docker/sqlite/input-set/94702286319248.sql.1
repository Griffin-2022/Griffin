PRAGMA auto_vacuum = OFF;
;CREATE VIRTUAL TABLE temp.stat USING dbstat;
;SELECT*FROM"temp".sqlite_master WHERE name='stat' AND sql='CREATE VIRTUAL TABLE stat USING dbstat' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE name='stat' AND sql='CREATE VIRTUAL TABLE stat USING dbstat' ORDER BY rowid
;SELECT * FROM stat;
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)
;
;PRAGMA journal_mode = WAL;
;PRAGMA journal_mode = delete;
;SELECT name, path, pageno, pagetype, ncell, payload, unused, mx_payload
      FROM stat;
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)
;
;CREATE TABLE t1(a, b);
;CREATE INDEX i1 ON t1(b);
;INSERT INTO t1(rowid, a, b) VALUES(2, 2, 3);
;INSERT INTO t1(rowid, a, b) VALUES(3, 4, 5);
;
;SELECT name, path, pageno, pagetype, ncell, payload, unused, mx_payload
      FROM stat WHERE name = 't1';
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)WHERE name='t1'
;
;SELECT name, path, pageno, pagetype, ncell, payload, unused, mx_payload
      FROM stat WHERE name = 'i1';
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)WHERE name='i1'
;
;SELECT name, path, pageno, pagetype, ncell, payload, unused, mx_payload
      FROM stat WHERE name = 'sqlite_schema';
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)WHERE name='sqlite_schema'
;
;DROP TABLE t1;
;
;CREATE TABLE t3(a PRIMARY KEY, b);
;INSERT INTO t3(rowid, a, b) VALUES(2, a_string(111), a_string(222));
;INSERT INTO t3 SELECT a_string(110+rowid), a_string(221+rowid) FROM t3
   ORDER BY rowid;
;SELECT name, path, pageno, pagetype, ncell, payload, unused, mx_payload
    FROM stat WHERE name != 'sqlite_schema' ORDER BY name;
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0) ORDER BY name
;
;SELECT * FROM dbstat WHERE aggregate=TRUE ORDER BY name;
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0) ORDER BY name
;
;UPDATE t3 SET a=a||hex(randomblob(700));
;VACUUM;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t3(a PRIMARY KEY, b)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t3' SELECT*FROM"main".'t3'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;SELECT pageno FROM stat EXCEPT SELECT pageno-1 FROM stat;
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)
;
;DROP TABLE t3;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;CREATE TABLE t4(x);
;CREATE INDEX i4 ON t4(x);
;INSERT INTO t4(rowid, x) VALUES(2, a_string(7777));
;SELECT name, path, pageno, pagetype, ncell, payload, unused, mx_payload
    FROM stat WHERE name != 'sqlite_schema' ORDER BY name;
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0) ORDER BY name
;
;SELECT *, '|' FROM dbstat WHERE aggregate=TRUE ORDER BY name;
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0) ORDER BY name
;
;CREATE TABLE t5(x);
;CREATE INDEX i5 ON t5(x);
;SELECT name, path, pageno, pagetype, ncell, payload, unused, mx_payload
    FROM stat WHERE name = 't5' OR name = 'i5';
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)WHERE name='i5'
;SELECT * FROM (SELECT 'sqlite_schema' AS name,1 AS rootpage,'table' AS type UNION ALL SELECT name,rootpage,type FROM "main".sqlite_schema WHERE rootpage!=0)WHERE name='t5'
;
;