CREATE TEMP TABLE swarm(id, tbl, minval, maxval);
;SELECT*FROM"temp".sqlite_master WHERE tbl_name='swarm' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE tbl_name='swarm' AND type!='trigger' ORDER BY rowid
;
;INSERT INTO swarm VALUES($i, 't1', $i, $i);
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;DROP TABLE IF EXISTS s 
;CREATE VIRTUAL TABLE temp.s USING swarmvtab(
        'SELECT :prefix || id, tbl, minval, minval FROM swarm',
        :prefix='test.db',
        missing=missing_db,
        openclose=openclose_db,
        maxopen=5
    )
  
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT :prefix || id, tbl, minval, minval FROM swarm'',
        :prefix=''test.db'',
        missing=missing_db,
        openclose=openclose_db,
        maxopen=5
    )' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT :prefix || id, tbl, minval, minval FROM swarm'',
        :prefix=''test.db'',
        missing=missing_db,
        openclose=openclose_db,
        maxopen=5
    )' ORDER BY rowid
;SELECT * FROM (SELECT :prefix || id, tbl, minval, minval FROM swarm) ORDER BY 3
;SELECT "missing_db"(?)
;SELECT "openclose_db"(?,?)
;SELECT b FROM s WHERE a<10;
;
;SELECT b FROM s WHERE (b%10)=0;
;
;DROP TABLE IF EXISTS s 
;CREATE VIRTUAL TABLE temp.s USING swarmvtab(
        'SELECT :prefix || id, tbl, minval, minval FROM swarm',
        :prefix='test.db',
        missing =       'missing_db',
        openclose=[openclose_db],
        maxopen = 3
    )
  
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT :prefix || id, tbl, minval, minval FROM swarm'',
        :prefix=''test.db'',
        missing =       ''missing_db'',
        openclose=[openclose_db],
        maxopen = 3
    )' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT :prefix || id, tbl, minval, minval FROM swarm'',
        :prefix=''test.db'',
        missing =       ''missing_db'',
        openclose=[openclose_db],
        maxopen = 3
    )' ORDER BY rowid
;SELECT * FROM (SELECT :prefix || id, tbl, minval, minval FROM swarm) ORDER BY 3
;SELECT "missing_db"(?)
;SELECT "openclose_db"(?,?)
;SELECT b FROM s WHERE a<10;
;
;SELECT b FROM s WHERE (b%10)=0;
;
;DROP TABLE IF EXISTS s 
;CREATE VIRTUAL TABLE temp.s USING swarmvtab(
        'SELECT :prefix||''.''||:suffix||id, tbl, minval, minval FROM swarm',
        :prefix=test, :suffix=db,
        missing =       'missing_db',
        openclose=[openclose_db],
        maxopen = 1
    )
  
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT :prefix||''''.''''||:suffix||id, tbl, minval, minval FROM swarm'',
        :prefix=test, :suffix=db,
        missing =       ''missing_db'',
        openclose=[openclose_db],
        maxopen = 1
    )' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT :prefix||''''.''''||:suffix||id, tbl, minval, minval FROM swarm'',
        :prefix=test, :suffix=db,
        missing =       ''missing_db'',
        openclose=[openclose_db],
        maxopen = 1
    )' ORDER BY rowid
;SELECT * FROM (SELECT :prefix||'.'||:suffix||id, tbl, minval, minval FROM swarm) ORDER BY 3
;SELECT "missing_db"(?)
;SELECT "openclose_db"(?,?)
;SELECT b FROM s WHERE a<10;
;
;SELECT b FROM s WHERE (b%10)=0;
;
;DROP TABLE IF EXISTS s 
;DROP TABLE IF EXISTS swarm;
;CREATE TEMP TABLE swarm(file, tbl, minval, maxval, ctx);
;SELECT*FROM"temp".sqlite_master WHERE tbl_name='swarm' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE tbl_name='swarm' AND type!='trigger' ORDER BY rowid
;
;INSERT INTO swarm VALUES('test.db' || $i, 't1', $i, $i, $file)
    
;DROP TABLE IF EXISTS s 
;CREATE VIRTUAL TABLE temp.s USING swarmvtab(
        'SELECT file, tbl, minval, minval, ctx FROM swarm',
        missing=missing_db,
        openclose=openclose_db,
        maxopen=5
    )
  
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT file, tbl, minval, minval, ctx FROM swarm'',
        missing=missing_db,
        openclose=openclose_db,
        maxopen=5
    )' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE name='s' AND sql='CREATE VIRTUAL TABLE s USING swarmvtab(
        ''SELECT file, tbl, minval, minval, ctx FROM swarm'',
        missing=missing_db,
        openclose=openclose_db,
        maxopen=5
    )' ORDER BY rowid
;SELECT * FROM (SELECT file, tbl, minval, minval, ctx FROM swarm) ORDER BY 3
;SELECT "missing_db"(?,?)
;SELECT "openclose_db"(?,?,?)
;SELECT b FROM s WHERE a<10;
;
;SELECT b FROM s WHERE (b%10)=0;
;
;