CREATE TABLE map(k, v);
;INSERT INTO map VALUES(1, 'one'), (2, 'two'), (3, 'three'), (4, 'four');
;CREATE TABLE t1(a INTEGER PRIMARY KEY, b, c);
;CREATE TRIGGER tr AFTER INSERT ON t1 BEGIN
    UPDATE t1 SET c = v FROM map WHERE k=new.a AND a=new.a;
  END;
;
;INSERT INTO t1(a) VALUES(1);
;
;SELECT a, c FROM t1 ORDER BY a;
;
;INSERT INTO t1(a) VALUES(2), (3), (4), (5);
;
;ATTACH 'test.db2' AS aux;
;SELECT*FROM"aux".sqlite_master ORDER BY rowid
;SELECT*FROM"aux".sqlite_master ORDER BY rowid
;CREATE TABLE aux.t3(x, y);
;SELECT*FROM"aux".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"aux".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;INSERT INTO aux.t3 VALUES('x', 'y');
;
;CREATE TRIGGER tr2 AFTER INSERT ON t1 BEGIN
    UPDATE t1 SET b = y FROM aux.t3 WHERE k=new.a;
  END;
;CREATE TEMP TRIGGER tr2 AFTER INSERT ON t1 BEGIN
    UPDATE t1 SET b = y FROM aux.t3 WHERE a=new.a;
  END;
;SELECT*FROM"temp".sqlite_master WHERE type='trigger' AND name='tr2' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE type='trigger' AND name='tr2' ORDER BY rowid
;INSERT INTO t1(a) VALUES(10), (20);
;SELECT * FROM t1;
;
;CREATE TABLE link(f, t);
;INSERT INTO link VALUES(5, 2), (20, 10), (2, 1);
;CREATE TRIGGER tr3 BEFORE DELETE ON t1 BEGIN
    UPDATE t1 SET b=coalesce(old.b,old.c) FROM main.link WHERE a=t AND old.a=f;
  END;
;DELETE FROM t1 WHERE a=2;
;SELECT * FROM t1;
;
;