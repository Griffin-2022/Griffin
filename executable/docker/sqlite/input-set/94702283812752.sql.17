CREATE TABLE t1(x, y);
;INSERT INTO t1 VALUES(1, 2);
;INSERT INTO t1 VALUES(3, 4);
;INSERT INTO t1 VALUES(5, 6);
;INSERT INTO t1 VALUES(7, 8);
;INSERT INTO t1 VALUES(9, 10);
;
;SELECT nth_value(x, 1) FROM t1;
;SELECT * FROM t1 WHERE nth_value(x, 1) OVER (ORDER BY y);
;SELECT count(*) FROM t1 GROUP BY y HAVING nth_value(x, 1) OVER (ORDER BY y);
;SELECT count(*) FROM t1 GROUP BY nth_value(x, 1) OVER (ORDER BY y);
;SELECT count(*) FROM t1 LIMIT nth_value(x, 1) OVER ();
;SELECT trim(x) OVER (ORDER BY y) FROM t1;
;SELECT max(x) OVER abc FROM t1 WINDOW def AS (ORDER BY y);
;SELECT row_number(x) OVER () FROM t1

;SELECT 
    lead(y) OVER win, 
    lead(y, 2) OVER win, 
    lead(y, 3, 'default') OVER win
  FROM t1
  WINDOW win AS (ORDER BY x)

;SELECT row_number() OVER (ORDER BY x) FROM t1

;SELECT 
    row_number() OVER win,
    lead(x) OVER win
  FROM t1
  WINDOW win AS (ORDER BY x ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)

;CREATE TABLE t3(a, b, c);
;WITH s(i) AS ( VALUES(1) UNION ALL SELECT i+1 FROM s WHERE i<6 )
  INSERT INTO t3 SELECT i, i, i FROM s;
;CREATE VIEW v1 AS SELECT
    sum(b) OVER (ORDER BY c),
    min(b) OVER (ORDER BY c),
    max(b) OVER (ORDER BY c)
  FROM t3;
;CREATE VIEW v2 AS SELECT
    sum(b) OVER win,
    min(b) OVER win,
    max(b) OVER win
  FROM t3
  WINDOW win AS (ORDER BY c);
;
;SELECT * FROM v1

;SELECT * FROM v2

;