PRAGMA auto_vacuum = 0;
;CREATE TABLE main.t1(a,b);
;WITH RECURSIVE c(x) AS (VALUES(1) UNION ALL SELECT x+1 FROM c WHERE x<1000)
    INSERT INTO t1(a,b) SELECT x, randomblob(1000) FROM c;
;CREATE TEMP TABLE ttemp(x,y);
;SELECT*FROM"temp".sqlite_master WHERE tbl_name='ttemp' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"temp".sqlite_master WHERE tbl_name='ttemp' AND type!='trigger' ORDER BY rowid
;INSERT INTO ttemp SELECT * FROM t1;
;ATTACH 'test2.db' AS x2;
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;ATTACH 'test3.db' AS x3;
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;CREATE TABLE x2.t2(c,d);
;SELECT*FROM"x2".sqlite_master WHERE tbl_name='t2' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"x2".sqlite_master WHERE tbl_name='t2' AND type!='trigger' ORDER BY rowid
;INSERT INTO t2 SELECT * FROM t1;
;CREATE TABLE x3.t3(e,f);
;SELECT*FROM"x3".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"x3".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;INSERT INTO t3 SELECT * FROM t1;
;DELETE FROM t1 WHERE (rowid%3)!=0;
;DELETE FROM t2 WHERE (rowid%4)!=0;
;DELETE FROM t3 WHERE (rowid%5)!=0;
;PRAGMA main.integrity_check;
;PRAGMA x2.integrity_check;
;PRAGMA x3.integrity_check;
;
;VACUUM main;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "main".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t1(a,b)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t1' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "main".sqlite_schema WHERE type='index'
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"main".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t1' SELECT*FROM"main".'t1'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "main".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;DELETE FROM t1;
;PRAGMA main.integrity_check;
;
;VACUUM x2;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "x2".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t2(c,d)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t2' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t2' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "x2".sqlite_schema WHERE type='index'
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"x2".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t2' SELECT*FROM"x2".'t2'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "x2".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;DELETE FROM t2;
;PRAGMA x2.integrity_check;
;
;VACUUM x3;
;ATTACH '' AS vacuum_db
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master ORDER BY rowid
;BEGIN
;SELECT sql FROM "x3".sqlite_schema WHERE type='table'AND name<>'sqlite_sequence' AND coalesce(rootpage,1)>0
;CREATE TABLE t3(e,f)
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT*FROM"vacuum_db".sqlite_master WHERE tbl_name='t3' AND type!='trigger' ORDER BY rowid
;SELECT sql FROM "x3".sqlite_schema WHERE type='index'
;SELECT'INSERT INTO vacuum_db.'||quote(name)||' SELECT*FROM"x3".'||quote(name)FROM vacuum_db.sqlite_schema WHERE type='table'AND coalesce(rootpage,1)>0
;INSERT INTO vacuum_db.'t3' SELECT*FROM"x3".'t3'
;INSERT INTO vacuum_db.sqlite_schema SELECT*FROM "x3".sqlite_schema WHERE type IN('view','trigger') OR(type='table'AND rootpage=0)
;
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;SELECT*FROM"x3".sqlite_master ORDER BY rowid
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;SELECT*FROM"x2".sqlite_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;SELECT*FROM"temp".sqlite_temp_master ORDER BY rowid
;PRAGMA temp.page_count
;VACUUM temp;
;
;PRAGMA temp.page_count;
;
;VACUUM olaf;
;