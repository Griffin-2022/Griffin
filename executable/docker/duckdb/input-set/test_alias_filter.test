# name: test/sql/filter/test_alias_filter.test
# description: Test filter on alias
# group: [filter]

;
PRAGMA enable_verification

;
CREATE TABLE integers(i INTEGER)

;
INSERT INTO integers VALUES (1), (2), (3), (NULL)

# this fails in postgres and monetdb, but succeeds in sqlite
;
SELECT i % 2 AS k FROM integers WHERE k<>0;
;
1
1

# These cases roughly follows what HAVING does.
# See test/sql/binder/test_having_alias.test.

# alias cannot be qualified
;
SELECT i % 2 AS k FROM integers WHERE integers.k<>0;

# columns take priority
;
SELECT i % 2 AS i FROM integers WHERE i<>0;
;
1
0
1

# columns with qualified name
;
SELECT i % 2 AS k FROM integers WHERE integers.i<>0;
;
1
0
1

# use the same alias multiple times
;
SELECT i % 2 AS k FROM integers WHERE k=k;
;
1
0
1

# alias to an aggregate doesn't work.
;
SELECT i % 2 AS o, COUNT(i) AS c FROM integers WHERE c = 0 GROUP BY o;
