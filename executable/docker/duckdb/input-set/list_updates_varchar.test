# name: test/sql/types/list/list_updates_varchar.test
# description: Test updates on varchar lists with in-memory storage
# group: [list]

;
CREATE TABLE a(id INTEGER, b VARCHAR[]);

;
INSERT INTO a VALUES (0, ['hello world', 'bananas']), (1, NULL), (2, ['3, 4, 5, 6', 'numbers']), (3, [NULL, 'not a number']);

;
SELECT * FROM a ORDER BY id
;
0	[hello world, bananas]
1	NULL
2	[3, 4, 5, 6, numbers]
3	[NULL, not a number]

# deletions
;
DELETE FROM a WHERE b[1][1]='3'
;
1

;
SELECT * FROM a ORDER BY id
;
0	[hello world, bananas]
1	NULL
3	[NULL, not a number]

# updates
;
UPDATE a SET b=['very very long string', '123', 'test 123 123'] WHERE b IS NULL
;
1

;
SELECT * FROM a ORDER BY id
;
0	[hello world, bananas]
1	[very very long string, 123, test 123 123]
3	[NULL, not a number]

;
UPDATE a SET b=NULL WHERE id>=2
;
1

;
SELECT * FROM a ORDER BY id
;
0	[hello world, bananas]
1	[very very long string, 123, test 123 123]
3	NULL

;
UPDATE a SET b=[NULL, 'hello again', NULL] WHERE id=1
;
1

;
SELECT * FROM a ORDER BY id
;
0	[hello world, bananas]
1	[NULL, hello again, NULL]
3	NULL

;
UPDATE a SET b=NULL
;
3

;
SELECT * FROM a ORDER BY id
;
0	NULL
1	NULL
3	NULL
