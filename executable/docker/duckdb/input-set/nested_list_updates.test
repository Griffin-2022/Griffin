# name: test/sql/types/list/nested_list_updates.test
# description: Test updates on nested lists with in-memory storage
# group: [list]

;
CREATE TABLE a(id INTEGER, b INTEGER[][]);

;
INSERT INTO a VALUES (0, [[1, 2], NULL, [3, NULL]]), (1, NULL), (2, [[4, 5, 6, 7], [NULL]])

;
SELECT * FROM a ORDER BY id
;
0	[[1, 2], NULL, [3, NULL]]
1	NULL
2	[[4, 5, 6, 7], [NULL]]

# updates
;
UPDATE a SET b=[[7, 8, 9], [10, 11]] WHERE b IS NULL
;
1

;
SELECT * FROM a ORDER BY id
;
0	[[1, 2], NULL, [3, NULL]]
1	[[7, 8, 9], [10, 11]]
2	[[4, 5, 6, 7], [NULL]]

;
UPDATE a SET b=NULL WHERE id>=1
;
2

;
SELECT * FROM a ORDER BY id
;
0	[[1, 2], NULL, [3, NULL]]
1	NULL
2	NULL

;
UPDATE a SET b=[[NULL], NULL, [NULL]] WHERE id=1
;
1

;
SELECT * FROM a ORDER BY id
;
0	[[1, 2], NULL, [3, NULL]]
1	[[NULL], NULL, [NULL]]
2	NULL

;
UPDATE a SET b=NULL
;
3

;
SELECT * FROM a ORDER BY id
;
0	NULL
1	NULL
2	NULL
