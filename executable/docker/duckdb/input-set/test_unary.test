# name: test/sql/function/numeric/test_unary.test
# description: Test unary operators
# group: [numeric]

;
PRAGMA enable_verification

;
CREATE TABLE test(i INTEGER)

;
INSERT INTO test VALUES (2)

;
SELECT ++-++-+i FROM test
;
2

# test simple unary operators
;
SELECT +i FROM test
;
2

;
SELECT -i FROM test
;
-2

# we can also stack unary functions
;
SELECT +++++++i FROM test
;
2

;
SELECT ++-++-+i FROM test
;
2

;
SELECT -+-+-+-+-i FROM test
;
-2

# Test negation of minima
;
CREATE TABLE minima (t TINYINT, s SMALLINT, i INTEGER, b BIGINT);

;
INSERT INTO minima VALUES (-128, -32768, -2147483648, -9223372036854775808);

;
SELECT -t from minima;

;
SELECT -s from minima;

;
SELECT -i from minima;

;
SELECT -b from minima;

# cannot apply these to a string
;
SELECT +'hello'

;
SELECT -'hello'

# cannot apply these to a date either
;
CREATE TABLE dates(d DATE)

;
INSERT INTO dates VALUES ('1992-02-02')

;
SELECT +d FROM dates

;
SELECT -d FROM dates
