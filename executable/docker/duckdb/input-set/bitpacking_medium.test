# name: test/sql/storage/compression/bitpacking/bitpacking_medium.test
# description: Test medium storage with bitpacking (> vector size)
# group: [bitpacking]

# load the DB from disk
load __TEST_DIR__/test_bitpacking.db

;
PRAGMA force_compression = 'bitpacking'

# simple Bitpacking with few values
;
CREATE TABLE test (a BIGINT);

# Insert values that fit in different widths
;
INSERT INTO test SELECT * FROM range(0, 10000);

;
SELECT SUM(a), MIN(a), MAX(a), COUNT(*) FROM test
;
49995000	0	9999	10000

restart

;
SELECT SUM(a), MIN(a), MAX(a), COUNT(*) FROM test
;
49995000	0	9999	10000
