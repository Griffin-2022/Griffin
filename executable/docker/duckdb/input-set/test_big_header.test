# name: test/sql/copy/csv/test_big_header.test
# description: Test big header
# group: [csv]

;
PRAGMA enable_verification

;
CREATE TABLE test (foo INTEGER, bar VARCHAR(10), baz VARCHAR(10), bam VARCHAR(10));

;
COPY test FROM 'test/sql/copy/csv/data/test/big_header.csv' (DELIMITER '	', HEADER false, SKIP 3);
;
3

;
SELECT COUNT(bam) FROM test WHERE bam = '!';
;
3

;
INSERT INTO test SELECT * FROM read_csv('test/sql/copy/csv/data/test/big_header.csv', HEADER=FALSE, SKIP=3, DELIM='	', columns=STRUCT_PACK(foo := 'INTEGER', bar := 'VARCHAR', baz := 'VARCHAR', bam := 'VARCHAR'));
;
3

;
SELECT COUNT(bam) FROM test WHERE bam = '!';
;
6

;
INSERT INTO test SELECT * FROM read_csv_auto('test/sql/copy/csv/data/test/big_header.csv', HEADER=FALSE, SKIP=3, DELIM='	');
;
3

;
SELECT COUNT(bam) FROM test WHERE bam = '!';
;
9

