# name: test/sql/aggregate/aggregates/test_kahan_sum.test
# description: Test sums in which temporary results are not exact
# group: [aggregates]

;
CREATE TABLE doubles(n DOUBLE);

;
INSERT INTO doubles (n) VALUES ('9007199254740992'::DOUBLE), (1::DOUBLE), (1::DOUBLE), (0::DOUBLE);

# this would give the wrong result with a simple sum
;
SELECT FSUM(n)::BIGINT FROM doubles;
;
9007199254740994

;
SELECT sumKahan(n)::BIGINT FROM doubles;
;
9007199254740994

;
SELECT kahan_sum(n)::BIGINT FROM doubles;
;
9007199254740994
