# name: test/sql/types/hugeint/test_hugeint_bitwise.test
# description: Test bitwise operations of huge int type
# group: [hugeint]

;
PRAGMA enable_verification

# left-shift
;
SELECT 1::HUGEINT << 3
;
8

;
SELECT 27::HUGEINT << 0
;
27

;
SELECT -27::HUGEINT << 1
;
0

# large shifts
;
select 1::HUGEINT << 50, 1::HUGEINT << 100;
;
1125899906842624	1267650600228229401496703205376

# shift chains
;
select (((((1::HUGEINT << 50) << 50) << 2) << 3) << 8), (1::HUGEINT)<<50<<20<<7<<18<<3<<6<<9
;
10384593717069655257060992658440192	10384593717069655257060992658440192

;
select 1::HUGEINT << 64;
;
18446744073709551616


# out of bounds shifts
;
select 1::HUGEINT << 200, '1329227995784915872903807060280344576'::HUGEINT << 50;
;
0	0

;
SELECT 27::HUGEINT << -1, 100::HUGEINT << '1329227995784915872903807060280344576'::HUGEINT
;
0	0

# right-shift
;
SELECT 8::HUGEINT >> 3
;
1

;
SELECT 27::HUGEINT >> 0
;
27

;
SELECT -27::HUGEINT >> 1
;
0

;
SELECT 27::HUGEINT >> -1
;
0

# large shifts
;
select (1::HUGEINT << 100) >> 50, (1::HUGEINT << 120)>>108;
;
1125899906842624	4096

;
SELECT '1329227995784915872903807060280344576'::HUGEINT >> 200
;
0

;
SELECT '1329227995784915872903807060280344576'::HUGEINT >> 64
;
72057594037927936

;
SELECT '1329227995784915872903807060280344576'::HUGEINT >> 4 >> 5 >> 7 >> 9 >> 12 >> 13
;
1180591620717411303424

# bitwise &
;
select 1::HUGEINT & 3::HUGEINT
;
1

;
select 51290852742897895128414::HUGEINT & 4923847238975289723895239078235::HUGEINT
;
40291148384447586808154

# bitwise |
;
select 1::HUGEINT | 2::HUGEINT
;
3

;
select 51290852742897895128414::HUGEINT | 4923847238975289723895239078235::HUGEINT
;
4923847249974994082345547398495

# bitwise xor
;
select xor(1::HUGEINT, 3::HUGEINT)
;
2

;
select xor(51290852742897895128414::HUGEINT, 4923847238975289723895239078235::HUGEINT)
;
4923847209683845697897960590341

# bitwise not
;
select ~(1::HUGEINT)
;
-2

;
select ~(4923847238975289723895239078235::HUGEINT)
;
-4923847238975289723895239078236

# big shifts
;
select 1::hugeint >> 1000;
;
0

;
select 1 >> 170141183460469231731687303715884105727::hugeint;
;
0

;
select 1::hugeint << 1000;
;
0

;
select 1 << 170141183460469231731687303715884105727::hugeint;
;
0
