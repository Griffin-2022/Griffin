# name: test/sql/types/unsigned/test_unsigned_conversion.test
# description: Test unsigned conversion
# group: [unsigned]

;
PRAGMA enable_verification

# Numbers that fit the unsigned types
;
SELECT '7'::UTINYINT, '130'::UTINYINT, '255'::UTINYINT
;
7	130	255

;
SELECT '7'::USMALLINT, '130'::USMALLINT, '65535'::USMALLINT
;
7	130	65535

;
SELECT '7'::UINTEGER, '130'::UINTEGER, '4294967295'::UINTEGER
;
7	130	4294967295

;
SELECT '7'::UBIGINT, '130'::UBIGINT, '18446744073709551615'::UBIGINT
;
7	130	18446744073709551615

# Numbers that do not fit the unsigned type
;
SELECT '265'::UTINYINT

;
SELECT '65536'::USMALLINT

;
SELECT '4294967296'::UINTEGER

;
SELECT '18446744073709551616'::UBIGINT

# Negative Numbers
;
SELECT '-1'::UTINYINT

;
SELECT '-1'::USMALLINT

;
SELECT '-1'::UINTEGER

;
SELECT '-1'::UBIGINT

# zero
;
SELECT '0'::UTINYINT, '-0'::UTINYINT
;
0	0


# cast various types to unsigned
;
SELECT 42::TINYINT::UTINYINT, 42::SMALLINT::UTINYINT, 42::INTEGER::UTINYINT, 42::BIGINT::UTINYINT, 42::FLOAT::UTINYINT, 42::DOUBLE::UTINYINT;
;
42	42	42	42	42	42

;
SELECT 42::TINYINT::USMALLINT, 42::SMALLINT::USMALLINT, 42::INTEGER::USMALLINT, 42::BIGINT::USMALLINT, 42::FLOAT::USMALLINT, 42::DOUBLE::USMALLINT;
;
42	42	42	42	42	42

;
SELECT 42::TINYINT::UINTEGER, 42::SMALLINT::UINTEGER, 42::INTEGER::UINTEGER, 42::BIGINT::UINTEGER, 42::FLOAT::UINTEGER, 42::DOUBLE::UINTEGER;
;
42	42	42	42	42	42

;
SELECT 42::TINYINT::UBIGINT, 42::SMALLINT::UBIGINT, 42::INTEGER::UBIGINT, 42::BIGINT::UBIGINT, 42::FLOAT::UBIGINT, 42::DOUBLE::UBIGINT;
;
42	42	42	42	42	42

# cast various types to unsigned (Larger than they can fit)
;
SELECT (9223372036854775807)::BIGINT::UTINYINT

;
SELECT (9223372036854775807)::BIGINT::USMALLINT

;
SELECT (9223372036854775807)::BIGINT::UINTEGER

# These should fit though
;
SELECT (9223372036854775807)::BIGINT::UBIGINT
;
9223372036854775807

;
SELECT (9223372036854775808)::HUGEINT::UBIGINT
;
9223372036854775808

# Negative Values
;
SELECT (-42)::TINYINT::UTINYINT

;
SELECT (-42)::TINYINT::USMALLINT

;
SELECT (-42)::TINYINT::UINTEGER

;
SELECT (-42)::TINYINT::UBIGINT

;
SELECT -42::TINYINT::UTINYINT
;
214

;
SELECT -42::TINYINT::USMALLINT
;
65494

;
SELECT -42::TINYINT::UINTEGER
;
4294967254

;
SELECT -42::TINYINT::UBIGINT
;
18446744073709551574

;
SELECT (-42)::SMALLINT::UTINYINT

;
SELECT (-42)::SMALLINT::USMALLINT

;
SELECT (-42)::SMALLINT::UINTEGER

;
SELECT (-42)::SMALLINT::UBIGINT

;
SELECT -42::SMALLINT::UTINYINT
;
214

;
SELECT -42::SMALLINT::USMALLINT
;
65494

;
SELECT -42::SMALLINT::UINTEGER
;
4294967254

;
SELECT -42::SMALLINT::UBIGINT
;
18446744073709551574

;
SELECT (-42)::INTEGER::UTINYINT

;
SELECT (-42)::INTEGER::USMALLINT

;
SELECT (-42)::INTEGER::UINTEGER

;
SELECT (-42)::INTEGER::UBIGINT

;
SELECT -42::INTEGER::UTINYINT
;
214

;
SELECT -42::INTEGER::USMALLINT
;
65494

;
SELECT -42::INTEGER::UINTEGER
;
4294967254

;
SELECT -42::INTEGER::UBIGINT
;
18446744073709551574

;
SELECT (-42)::BIGINT::UTINYINT

;
SELECT (-42)::BIGINT::USMALLINT

;
SELECT (-42)::BIGINT::UINTEGER

;
SELECT (-42)::BIGINT::UBIGINT

;
SELECT -42::BIGINT::UTINYINT
;
214

;
SELECT -42::BIGINT::USMALLINT
;
65494

;
SELECT -42::BIGINT::UINTEGER
;
4294967254

;
SELECT -42::BIGINT::UBIGINT
;
18446744073709551574

;
SELECT (-42)::FLOAT::UTINYINT

;
SELECT (-42)::FLOAT::USMALLINT

;
SELECT (-42)::FLOAT::UINTEGER

;
SELECT (-42)::FLOAT::UBIGINT

;
SELECT -42::FLOAT::UTINYINT
;
214

;
SELECT -42::FLOAT::USMALLINT
;
65494

;
SELECT -42::FLOAT::UINTEGER
;
4294967254

;
SELECT -42::FLOAT::UBIGINT
;
18446744073709551574

;
SELECT (-42)::DOUBLE::UTINYINT

;
SELECT (-42)::DOUBLE::USMALLINT

;
SELECT (-42)::DOUBLE::UINTEGER

;
SELECT (-42)::DOUBLE::UBIGINT

;
SELECT -42::DOUBLE::UTINYINT
;
214

;
SELECT -42::DOUBLE::USMALLINT
;
65494

;
SELECT -42::DOUBLE::UINTEGER
;
4294967254

;
SELECT -42::DOUBLE::UBIGINT
;
18446744073709551574

# Convert unsigned to signed
;
SELECT (200)::UTINYINT::TINYINT

;
SELECT (10)::UTINYINT::TINYINT
;
10

;
SELECT (10)::UTINYINT::SMALLINT
;
10

;
SELECT (10)::UTINYINT::INTEGER
;
10

;
SELECT (10)::UTINYINT::BIGINT
;
10

;
SELECT (200)::USMALLINT::TINYINT

;
SELECT (33000)::USMALLINT::SMALLINT

;
SELECT (10)::USMALLINT::TINYINT
;
10

;
SELECT (10)::USMALLINT::SMALLINT
;
10

;
SELECT (10)::USMALLINT::INTEGER
;
10

;
SELECT (10)::USMALLINT::BIGINT
;
10

;
SELECT (200)::UINTEGER::TINYINT

;
SELECT (33000)::UINTEGER::SMALLINT

;
SELECT (3147483647)::UINTEGER::INTEGER

;
SELECT (10)::UINTEGER::TINYINT
;
10

;
SELECT (10)::UINTEGER::SMALLINT
;
10

;
SELECT (10)::UINTEGER::INTEGER
;
10

;
SELECT (10)::UINTEGER::BIGINT
;
10

;
SELECT (200)::UBIGINT::TINYINT

;
SELECT (33000)::UBIGINT::SMALLINT

;
SELECT (3147483647)::UBIGINT::INTEGER


;
SELECT (10223372036854775807)::UBIGINT::INTEGER

;
SELECT (10)::UBIGINT::TINYINT
;
10

;
SELECT (10)::UBIGINT::SMALLINT
;
10

;
SELECT (10)::UBIGINT::INTEGER
;
10

;
SELECT (10)::UBIGINT::BIGINT
;
10


;
SELECT (9223372036854775807)::BIGINT::USMALLINT

;
SELECT (9223372036854775807)::BIGINT::UINTEGER

# These should fit though
;
SELECT (9223372036854775807)::BIGINT::UBIGINT
;
9223372036854775807

;
SELECT (9223372036854775808)::HUGEINT::UBIGINT
;
9223372036854775808



# Cast Decimal to Unsigned Values
;
SELECT (200.32)::DECIMAL::UTINYINT
;
200

;
SELECT (260.32)::DECIMAL::UTINYINT

;
SELECT (200.32)::DECIMAL::USMALLINT
;
200

;
SELECT (65535.32)::DECIMAL::USMALLINT
;
65535

;
SELECT (65536.32)::DECIMAL::USMALLINT


;
SELECT (200.32)::DECIMAL::UINTEGER
;
200

;
SELECT (4294967295.32)::DECIMAL::UINTEGER
;
4294967295

;
SELECT (4294967296.32)::DECIMAL::UINTEGER

;
SELECT (200.32)::DECIMAL::UBIGINT
;
200

# Cast REAL to Unsigned Values
;
SELECT (200.32)::REAL::UTINYINT
;
200

;
SELECT (260.32)::REAL::UTINYINT

;
SELECT (200.32)::REAL::USMALLINT
;
200

;
SELECT (65534.32)::REAL::USMALLINT
;
65534

;
SELECT (65536.32)::REAL::USMALLINT


;
SELECT (200.32)::REAL::UINTEGER
;
200

;
SELECT (200.32)::REAL::UINTEGER
;
200

;
SELECT (4294967296.32)::REAL::UBIGINT
;
4294967296
