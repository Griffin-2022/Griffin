# name: test/sql/types/hugeint/test_hugeint_arithmetic.test
# description: Test arithmetic with huge integers
# group: [hugeint]

;
PRAGMA enable_verification

# negation
;
SELECT -(100::HUGEINT), -(-(50::HUGEINT));
;
-100	50

# negate 0
;
SELECT -(0::HUGEINT)
;
0

# negation with large numbers
;
SELECT -(100000000000000000000::HUGEINT), -(-(100000000000000000000::HUGEINT));
;
-100000000000000000000	100000000000000000000

# addition
# simple addition: small values
;
SELECT 42::HUGEINT + 42::HUGEINT;
;
84

# negative values
;
SELECT 42::HUGEINT + -42::HUGEINT, -42::HUGEINT + 100::HUGEINT, -42::HUGEINT+-42::HUGEINT;
;
0	58	-84

# large values
;
SELECT '100000000000000000000'::HUGEINT + '100000000000000000000'::HUGEINT;
;
200000000000000000000

# large negative values
;
SELECT '100000000000000000000'::HUGEINT + '-1000000000000000000000'::HUGEINT;
;
-900000000000000000000

;
SELECT '5'::HUGEINT + '-10000000000000000002'::HUGEINT;
;
-9999999999999999997

# overflow in addition
;
SELECT '170141183460469231731687303715884105727'::HUGEINT + '170141183460469231731687303715884105727'::HUGEINT;

;
SELECT '170141183460469231731687303715884105727'::HUGEINT + '10'::HUGEINT;

# almost overflowing but not quite
;
SELECT '170141183460469231731687303715884105727'::HUGEINT - 10::HUGEINT + 10::HUGEINT
;
170141183460469231731687303715884105727

;
SELECT '-170141183460469231731687303715884105727'::HUGEINT + 10::HUGEINT - 10::HUGEINT
;
-170141183460469231731687303715884105727

# overflowing
;
SELECT '170141183460469231731687303715884105727'::HUGEINT - 10::HUGEINT + 11::HUGEINT

;
SELECT '-170141183460469231731687303715884105727'::HUGEINT + 10::HUGEINT - 11::HUGEINT

# subtraction
;
SELECT 100::HUGEINT - 42::HUGEINT, 3::HUGEINT - 5::HUGEINT;
;
58	-2

# negative combinations
;
SELECT -100::HUGEINT - 42::HUGEINT, -3::HUGEINT - 5::HUGEINT, 12::HUGEINT-(-12::HUGEINT);
;
-142	-8	24

# large subtraction
;
SELECT '-10000000000000000002'::HUGEINT - '-10000000000000000002'::HUGEINT;
;
0

# underflow in subtraction
;
SELECT '-170141183460469231731687303715884105727'::HUGEINT - '170141183460469231731687303715884105727'::HUGEINT;

;
SELECT '170141183460469231731687303715884105727'::HUGEINT - '-170141183460469231731687303715884105727'::HUGEINT;

# multiplication
;
SELECT 100::HUGEINT * 50::HUGEINT;
;
5000

# negative multiplication
;
SELECT 100::HUGEINT * -50::HUGEINT, -100::HUGEINT * 50::HUGEINT, -100::HUGEINT * -50::HUGEINT;
;
-5000	-5000	5000

# multiplying large numbers
;
SELECT '1701411834604692317'::HUGEINT * '2'::HUGEINT, '100000000000000000000'::HUGEINT * '1000000000000000000'::HUGEINT
;
3402823669209384634	100000000000000000000000000000000000000

;
SELECT '170141183460469231731687303715884105727'::HUGEINT * 1::HUGEINT
;
170141183460469231731687303715884105727

# overflow in multiplication
;
SELECT '170141183460469231731687303715884105727'::HUGEINT * 2::HUGEINT

;
SELECT '1701411834604692317'::HUGEINT * '131687303715884105727'::HUGEINT

# division
;
SELECT 100::HUGEINT / 20::HUGEINT, 90::HUGEINT / 20::HUGEINT
;
5	4

# negative values
;
SELECT -100::HUGEINT / 20::HUGEINT, 100::HUGEINT / -20::HUGEINT, -100::HUGEINT / -20::HUGEINT
;
-5	-5	5

# division by zero
;
SELECT 100::HUGEINT / 0::HUGEINT
;
NULL

# large values
;
SELECT '100000000000000000000000000000000000000'::HUGEINT / '10000000000000'::HUGEINT, '100000000000000000000000000000000000000'::HUGEINT / '2'::HUGEINT
;
10000000000000000000000000	50000000000000000000000000000000000000

# modulo
;
SELECT 100::HUGEINT % 20::HUGEINT, 90::HUGEINT % 20::HUGEINT
;
0	10

# negative values
;
SELECT -90 % 20, 90 % -20, -90 % -20
;
-10	10	-10

;
SELECT -90::HUGEINT % 20::HUGEINT, 90::HUGEINT % -20::HUGEINT, -90::HUGEINT % -20::HUGEINT
;
-10	10	-10

# modulo by zero
;
SELECT 100::HUGEINT % 0::HUGEINT
;
NULL

# large values
;
SELECT '100000000000000000000000000000000000000'::HUGEINT % '6587689457689375689735'::HUGEINT, '100000000000000000000000000000000000000'::HUGEINT % '3'::HUGEINT
;
5396771390320972230850	1

# abs
;
SELECT ABS('100'::HUGEINT), ABS('-100'::HUGEINT);;
;
100	100

# addition
;
SELECT '-170141183460469231731687303715884105726'::HUGEINT + -1;
;
-170141183460469231731687303715884105727

;
SELECT '170141183460469231731687303715884105726'::HUGEINT + 1;
;
170141183460469231731687303715884105727

;
SELECT -170141183460469231731687303715884105727 + -1;

;
SELECT 170141183460469231731687303715884105727 + 1;

# the other way around (i.e. move away from the overflow direction)
;
SELECT '170141183460469231731687303715884105727'::HUGEINT + -1;
;
170141183460469231731687303715884105726

;
SELECT '-170141183460469231731687303715884105727'::HUGEINT + 1;
;
-170141183460469231731687303715884105726

# now the reverse: right side is big
;
SELECT -1 + '-170141183460469231731687303715884105726'::HUGEINT;
;
-170141183460469231731687303715884105727

;
SELECT 1 + '170141183460469231731687303715884105726'::HUGEINT;
;
170141183460469231731687303715884105727

;
SELECT -1 + -170141183460469231731687303715884105727;

;
SELECT 1 + 170141183460469231731687303715884105727;

# the other way around (i.e. move away from the overflow direction)
;
SELECT -1 + '170141183460469231731687303715884105727'::HUGEINT;
;
170141183460469231731687303715884105726

;
SELECT 1 + '-170141183460469231731687303715884105727'::HUGEINT;
;
-170141183460469231731687303715884105726

# subtraction
;
SELECT '-170141183460469231731687303715884105726'::HUGEINT - 1;
;
-170141183460469231731687303715884105727

;
SELECT -170141183460469231731687303715884105727 - 1;

;
SELECT 170141183460469231731687303715884105724 - (-1);
;
170141183460469231731687303715884105725

;
SELECT 170141183460469231731687303715884105725 - (-1);
;
170141183460469231731687303715884105726

;
SELECT 170141183460469231731687303715884105726 - (-1);
;
170141183460469231731687303715884105727

;
SELECT 170141183460469231731687303715884105727 - (-1);

# the other way around (i.e. move away from the overflow direction)
;
SELECT 170141183460469231731687303715884105727 - 1;
;
170141183460469231731687303715884105726

;
SELECT -170141183460469231731687303715884105727 - (-1);
;
-170141183460469231731687303715884105726

# now the reverse: right side is big
;
SELECT -1 - 170141183460469231731687303715884105726;
;
-170141183460469231731687303715884105727

;
SELECT -1 - 170141183460469231731687303715884105727;

;
SELECT 1 - (-170141183460469231731687303715884105724);
;
170141183460469231731687303715884105725

;
SELECT 1 - (-170141183460469231731687303715884105725);
;
170141183460469231731687303715884105726

;
SELECT 1 - (-170141183460469231731687303715884105726);
;
170141183460469231731687303715884105727

;
SELECT 1 - (-170141183460469231731687303715884105727);

# the other way around (i.e. move away from the overflow direction)
;
SELECT -1 - (-170141183460469231731687303715884105727);
;
170141183460469231731687303715884105726

;
SELECT 1 - 170141183460469231731687303715884105727;
;
-170141183460469231731687303715884105726

# multiplication
;
SELECT 170141183460469231731687303715884105727 * 1;
;
170141183460469231731687303715884105727

;
SELECT 170141183460469231731687303715884105727 * -1;
;
-170141183460469231731687303715884105727

;
SELECT -170141183460469231731687303715884105727 * 1;
;
-170141183460469231731687303715884105727

;
SELECT -170141183460469231731687303715884105727 * -1;
;
170141183460469231731687303715884105727

;
SELECT 85070591730234615865843651857942052864 * 2

;
SELECT -85070591730234615865843651857942052864 * 2

;
SELECT 85070591730234615865843651857942052864 * -2

;
SELECT -85070591730234615865843651857942052864 * -2

# division
;
SELECT 170141183460469231731687303715884105727 / 1;
;
170141183460469231731687303715884105727

;
SELECT 170141183460469231731687303715884105727 / -1;
;
-170141183460469231731687303715884105727

;
SELECT -170141183460469231731687303715884105727 / 1;
;
-170141183460469231731687303715884105727

;
SELECT -170141183460469231731687303715884105727 / -1;
;
170141183460469231731687303715884105727

# comparisons
;
SELECT '5'::HUGEINT <> '5'::HUGEINT, '5'::HUGEINT <> '18446744073709551621'::HUGEINT
;
false	true
