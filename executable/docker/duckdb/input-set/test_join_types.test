# name: test/sql/join/inner/test_join_types.test
# description: Test joins with different types
# group: [inner]

;
PRAGMA enable_verification

# numeric types

foreach type <numeric> decimal(4,1) decimal(8,1) decimal(12,1) decimal(18,1)

;
begin transaction

;
create table a as select i::${type} AS i from range(1, 101, 1) t1(i)

# range joins
;
select count(*), sum(i) from a, (SELECT 100::${type} AS j) b where i < j
;
99	4950.000000

;
select count(*) from a, (SELECT 100::${type} AS j) b where i <= j
;
100

;
select count(*) from a, (SELECT 1::${type} AS j) b where i > j
;
99

;
select count(*) from a, (SELECT 1::${type} AS j) b where i >= j
;
100

# inequality join
;
select count(*) from a, (SELECT 1::${type} AS j) b where i <> j
;
99

;
select count(*) from a, (SELECT 1::${type} AS j) b where i <> j AND i=j
;
0

# equality join
;
select count(*) from a, (SELECT 1::${type} AS j) b where i = j
;
1

# no results on one side
;
select count(*) from a, (SELECT 1::${type} AS j) b where i > j AND i>120
;
0

;
select count(*) from a, (SELECT 1::${type} AS j) b where i <> j AND i>120
;
0

;
select count(*) from a, (SELECT 1::${type} AS j) b where i = j AND i>120
;
0

;
rollback

endloop
