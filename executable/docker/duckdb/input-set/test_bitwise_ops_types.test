# name: test/sql/function/operator/test_bitwise_ops_types.test
# description: Test bitwise ops with tables and different types
# group: [operator]

;
PRAGMA enable_verification

# type TINYINT
;
BEGIN TRANSACTION

;
CREATE TABLE bitwise_test(i TINYINT, j TINYINT)

;
INSERT INTO bitwise_test VALUES (1, 1), (1, 0), (0, 1), (0, 0), (1, NULL), (NULL, 1), (NULL, NULL)

;
SELECT i << j, i >> j, i & j, i | j, xor(i, j) FROM bitwise_test
;
2	0	1	1	0
1	1	0	1	1
0	0	0	1	1
0	0	0	0	0
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL

;
ROLLBACK

# type SMALLINT
;
BEGIN TRANSACTION

;
CREATE TABLE bitwise_test(i SMALLINT, j SMALLINT)

;
INSERT INTO bitwise_test VALUES (1, 1), (1, 0), (0, 1), (0, 0), (1, NULL), (NULL, 1), (NULL, NULL)

;
SELECT i << j, i >> j, i & j, i | j, xor(i, j) FROM bitwise_test
;
2	0	1	1	0
1	1	0	1	1
0	0	0	1	1
0	0	0	0	0
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL

;
ROLLBACK

# type INTEGER
;
BEGIN TRANSACTION

;
CREATE TABLE bitwise_test(i INTEGER, j INTEGER)

;
INSERT INTO bitwise_test VALUES (1, 1), (1, 0), (0, 1), (0, 0), (1, NULL), (NULL, 1), (NULL, NULL)

;
SELECT i << j, i >> j, i & j, i | j, xor(i, j) FROM bitwise_test
;
2	0	1	1	0
1	1	0	1	1
0	0	0	1	1
0	0	0	0	0
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL

;
ROLLBACK

# type BIGINT
;
BEGIN TRANSACTION

;
CREATE TABLE bitwise_test(i BIGINT, j BIGINT)

;
INSERT INTO bitwise_test VALUES (1, 1), (1, 0), (0, 1), (0, 0), (1, NULL), (NULL, 1), (NULL, NULL)

;
SELECT i << j, i >> j, i & j, i | j, xor(i, j) FROM bitwise_test
;
2	0	1	1	0
1	1	0	1	1
0	0	0	1	1
0	0	0	0	0
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL

;
ROLLBACK

