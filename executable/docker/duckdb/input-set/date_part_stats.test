# name: test/sql/function/date/date_part_stats.test
# description: Test date part stats on empty table
# group: [date]

;
PRAGMA enable_verification

;
CREATE TABLE dates(d DATE);

# test stats propagation from empty table
;
SELECT EXTRACT(year FROM d) FROM dates;
;

;
SELECT EXTRACT(month FROM d) FROM dates;
;

;
SELECT EXTRACT(day FROM d) FROM dates;
;

;
SELECT EXTRACT(decade FROM d) FROM dates;
;

;
SELECT EXTRACT(century FROM d) FROM dates;
;

;
SELECT EXTRACT(millennium FROM d) FROM dates;
;

;
SELECT EXTRACT(microseconds FROM d) FROM dates;
;

;
SELECT EXTRACT(milliseconds FROM d) FROM dates;
;

;
SELECT EXTRACT(second FROM d) FROM dates;
;

;
SELECT EXTRACT(minute FROM d) FROM dates;
;

;
SELECT EXTRACT(hour FROM d) FROM dates;
;

;
SELECT EXTRACT(epoch FROM d) FROM dates;
;

;
SELECT EXTRACT(dow FROM d) FROM dates;
;

;
SELECT EXTRACT(isodow FROM d) FROM dates;
;

;
SELECT EXTRACT(week FROM d) FROM dates;
;

;
SELECT EXTRACT(doy FROM d) FROM dates;
;

;
SELECT EXTRACT(quarter FROM d) FROM dates;
;

;
SELECT YEARWEEK(d) FROM dates;
;

;
SELECT DAYOFMONTH(d) FROM dates;
;

;
SELECT WEEKDAY(d) FROM dates;
;

;
SELECT WEEKOFYEAR(d) FROM dates;
;

;
PRAGMA disable_verification

;
INSERT INTO dates VALUES (DATE '1992-01-01'), (DATE '2000-12-31');

;
SELECT stats(EXTRACT(YEAR FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*1992.*2000.*

;
SELECT stats(EXTRACT(month FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*12.*

;
SELECT stats(EXTRACT(day FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*31.*

;
SELECT stats(EXTRACT(decade FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*199.*200.*

;
SELECT stats(EXTRACT(century FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*20.*20.*

;
SELECT stats(EXTRACT(millennium FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*2.*2.*

;
SELECT stats(EXTRACT(microseconds FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*0.*60000000.*

;
SELECT stats(EXTRACT(milliseconds FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*0.*60000.*

;
SELECT stats(EXTRACT(second FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*0.*60.*

;
SELECT stats(EXTRACT(minute FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*0.*60.*

;
SELECT stats(EXTRACT(hour FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*0.*24.*

;
SELECT stats(EXTRACT(dow FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*0.*6.*

;
SELECT stats(EXTRACT(isodow FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*7.*

;
SELECT stats(EXTRACT(week FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*54.*

;
SELECT stats(EXTRACT(doy FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*366.*

;
SELECT stats(EXTRACT(quarter FROM d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*4.*

;
SELECT stats(YEARWEEK(d)) FROM dates LIMIT 1;
;
<REGEX>:.*199201.*200052.*

;
SELECT stats(DAYOFMONTH(d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*31.*

;
SELECT stats(WEEKDAY(d)) FROM dates LIMIT 1;
;
<REGEX>:.*0.*6.*

;
SELECT stats(WEEKOFYEAR(d)) FROM dates LIMIT 1;
;
<REGEX>:.*1.*54.*

