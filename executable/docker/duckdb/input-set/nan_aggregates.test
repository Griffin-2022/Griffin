# name: test/sql/types/float/nan_aggregates.test
# description: Test aggregates on NaN values
# group: [float]

;
PRAGMA enable_verification

foreach type FLOAT DOUBLE

;
SELECT SUM('inf'::${type}), SUM('-inf'::${type}), SUM('nan'::${type})

;
SELECT MIN('inf'::${type}), MIN('-inf'::${type}), MIN('nan'::${type})
;
inf	-inf	nan

;
SELECT MAX('inf'::${type}), MAX('-inf'::${type}), MAX('nan'::${type})
;
inf	-inf	nan

;
create table floats(f ${type});

;
insert into floats values ('inf'), ('-inf'), ('nan');

;
SELECT MIN(f), MAX(f) FROM floats
;
-inf	nan

;
DROP TABLE floats

endloop
