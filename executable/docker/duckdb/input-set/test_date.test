# name: test/sql/types/date/test_date.test
# description: Test basic DATE functionality
# group: [date]

;
PRAGMA enable_verification

# create and insert into table
;
CREATE TABLE dates(i DATE)

;
INSERT INTO dates VALUES ('1993-08-14'), (NULL)

# check that we can select dates
;
SELECT * FROM dates
;
1993-08-14
NULL

# YEAR function
;
SELECT year(i) FROM dates
;
1993
NULL

# check that we can convert dates to string
;
SELECT cast(i AS VARCHAR) FROM dates
;
1993-08-14
NULL

# check that we can add days to a date
;
SELECT i + 5 FROM dates
;
1993-08-19
NULL

# check that we can subtract days from a date
;
SELECT i - 5 FROM dates
;
1993-08-09
NULL

# HOWEVER, we can't divide or multiply or modulo
;
SELECT i * 3 FROM dates

;
SELECT i / 3 FROM dates

;
SELECT i % 3 FROM dates

# we also can't add two dates together
;
SELECT i + i FROM dates

# but we can subtract them! resulting in an integer
;
SELECT (i + 5) - i FROM dates
;
5
NULL

;
SELECT ''::DATE

;
SELECT '  '::DATE

;
SELECT '1992'::DATE

;
SELECT '1992-'::DATE

;
SELECT '1992-01'::DATE

;
SELECT '1992-01-'::DATE

;
SELECT '30000307-01-01 (BC)'::DATE
