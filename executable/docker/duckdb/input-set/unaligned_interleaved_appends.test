# name: test/sql/insert/unaligned_interleaved_appends.test
# description: Test unaligned interleaved appends
# group: [insert]

;
CREATE TABLE integers(i INTEGER)

;
BEGIN TRANSACTION

# con2 insert 5 rows and begins a transaction
;
INSERT INTO integers SELECT * FROM range(0, 5)

;
BEGIN TRANSACTION

# con3 inserts 17 rows and begins a transaction
;
INSERT INTO integers SELECT * FROM range(0, 17)

;
BEGIN TRANSACTION

# con4 inserts 1007 rows and begins a transaction
;
INSERT INTO integers SELECT * FROM range(0, 1007)

;
BEGIN TRANSACTION

# con5 inserts 3020 rows and begins a transaction
;
INSERT INTO integers SELECT * FROM range(0, 3020)

;
BEGIN TRANSACTION

# con6 inserts 3 rows and begins a transaction
;
INSERT INTO integers SELECT * FROM range(0, 3)

;
BEGIN TRANSACTION

# now we verify all the counts
# con1: 0
;
SELECT COUNT(*) FROM integers
;
0

# con2: 5
;
SELECT COUNT(*) FROM integers
;
5

# con3: 22
;
SELECT COUNT(*) FROM integers
;
22

# con4: 1029
;
SELECT COUNT(*) FROM integers
;
1029

# con5: 4049
;
SELECT COUNT(*) FROM integers
;
4049

# con6: 4052
;
SELECT COUNT(*) FROM integers
;
4052
