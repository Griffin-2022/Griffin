# name: test/sql/function/list/generate_series.test
# description: Test generate_series/range function
# group: [list]

;
PRAGMA enable_verification

# range with a single parameter
;
SELECT range(3)
;
[0, 1, 2]

;
SELECT generate_series(3)
;
[0, 1, 2, 3]

;
SELECT range(3) FROM range(3)
;
[0, 1, 2]
[0, 1, 2]
[0, 1, 2]

;
SELECT range(i) FROM range(3) tbl(i)
;
[]
[0]
[0, 1]

;
SELECT range(NULL) FROM range(3) tbl(i)
;
NULL
NULL
NULL

;
SELECT range(CASE WHEN i%2=0 THEN NULL ELSE i END) FROM range(6) tbl(i)
;
NULL
[0]
NULL
[0, 1, 2]
NULL
[0, 1, 2, 3, 4]

;
SELECT range(0)
;
[]

;
SELECT range(-1)
;
[]

;
SELECT range(NULL)
;
NULL

# range with two parameters
;
SELECT range(1, 3)
;
[1, 2]

;
SELECT generate_series(1, 3)
;
[1, 2, 3]

;
SELECT range(1, 1)
;
[]

;
SELECT range(-10, -5)
;
[-10, -9, -8, -7, -6]

;
SELECT generate_series(1, 1)
;
[1]

;
SELECT range(3, 1)
;
[]

;
SELECT range(NULL, 1)
;
NULL

;
SELECT range(1, NULL)
;
NULL

;
SELECT range(NULL, NULL)
;
NULL

;
SELECT range(i, 5) FROM range(5) tbl(i)
;
[0, 1, 2, 3, 4]
[1, 2, 3, 4]
[2, 3, 4]
[3, 4]
[4]

;
SELECT range(0, i) FROM range(5) tbl(i)
;
[]
[0]
[0, 1]
[0, 1, 2]
[0, 1, 2, 3]

# range with 3 parameters
;
SELECT range(1, 6, 2)
;
[1, 3, 5]

;
SELECT generate_series(1, 6, 2)
;
[1, 3, 5]

;
SELECT generate_series(1, 7, 2)
;
[1, 3, 5, 7]

;
SELECT range(1, 10, 100)
;
[1]

;
SELECT range(1, 10, 0)
;
[]

;
SELECT range(3, 1, -1)
;
[3, 2]

;
SELECT generate_series(3, 1, -1)
;
[3, 2, 1]

;
SELECT range(3, 1, 1)
;
[]

;
SELECT range(1, 3, -1)
;
[]

;
SELECT range(4, 1, -1)
;
[4, 3, 2]

;
SELECT range(50, 1, -20)
;
[50, 30, 10]

;
SELECT generate_series(50, 1, -20)
;
[50, 30, 10]

;
SELECT generate_series(50, -10, -20)
;
[50, 30, 10, -10]

;
SELECT range(NULL, 1, 1)
;
NULL

;
SELECT range(1, NULL, 1)
;
NULL

;
SELECT range(1, 1, NULL)
;
NULL

;
SELECT range(NULL, NULL, NULL)
;
NULL
