# name: test/sql/function/string/test_complex_unicode.test
# description: Test correct behavior of various string functions under complex unicode characters
# group: [string]

;
PRAGMA enable_verification

# length with grapheme clusters
;
SELECT length('S̈a')
;
2

;
SELECT length('🤦🏼‍♂️')
;
1

;
SELECT length('🤦🏼‍♂️ L🤦🏼‍♂️R 🤦🏼‍♂️')
;
7

# strlen returns size in bytes
;
SELECT strlen('🤦🏼‍♂️')
;
17

;
SELECT strlen('S̈a')
;
4

# reverse with grapheme clusters
;
SELECT REVERSE('S̈a︍')
;
a︍S̈

;
SELECT REVERSE('Z͑ͫ̓ͪ̂ͫ̽͏̴̙̤̞͉͚̯̞̠͍A̴̵̜̰͔ͫ͗͢')
;
A̴̵̜̰͔ͫ͗͢Z͑ͫ̓ͪ̂ͫ̽͏̴̙̤̞͉͚̯̞̠͍

;
SELECT REVERSE('🤦🏼‍♂️')
;
🤦🏼‍♂️

;
SELECT REVERSE('🤦🏼‍♂️ L🤦🏼‍♂️R 🤦🏼‍♂️')
;
🤦🏼‍♂️ R🤦🏼‍♂️L 🤦🏼‍♂️

;
SELECT REVERSE('MotörHead')
;
daeHrötoM

# substring with grapheme clusters
;
SELECT substring('🤦🏼‍♂️🤦🏼‍♂️🤦🏼‍♂️', 1, 1)
;
🤦🏼‍♂️

;
SELECT substring('S̈a︍', 2, 1)
;
a︍

;
SELECT substring('test: 🤦🏼‍♂️hello🤦🏼‍♂️ world', 7, 7)
;
🤦🏼‍♂️hello🤦🏼‍♂️

;
SELECT substring('S̈a', 1, 1)
;
S̈

;
SELECT substring('S̈a︍', -1, 1)
;
a︍
