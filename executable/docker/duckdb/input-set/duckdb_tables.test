# name: test/sql/table_function/duckdb_tables.test
# description: Test duckdb_tables function
# group: [table_function]

;
SELECT COUNT(*) FROM duckdb_tables();
;
0

;
CREATE TABLE integers(i INTEGER)

;
CREATE TABLE pk(i INTEGER PRIMARY KEY, j VARCHAR, CHECK(i<100))

;
CREATE SCHEMA myschema;

;
CREATE TABLE myschema.mytable(k DOUBLE)

;
CREATE TEMPORARY TABLE mytemp(i INTEGER)

;
CREATE VIEW v1 AS SELECT 42

;
SELECT schema_name, table_name, temporary, has_primary_key, estimated_size, column_count, index_count, check_constraint_count FROM duckdb_tables() ORDER BY table_name;
;
main	integers	False	False	0	1	0	0
myschema	mytable	False	False	0	1	0	0
temp	mytemp	True	False	0	1	0	0
main	pk	False	True	0	2	1	1
