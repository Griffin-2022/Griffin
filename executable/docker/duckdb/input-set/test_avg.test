# name: test/sql/aggregate/aggregates/test_avg.test
# description: Test AVG operator
# group: [aggregates]

# scalar average
;
SELECT AVG(3), AVG(NULL)
;
3
NULL

;
SELECT AVG(3::SMALLINT), AVG(NULL::SMALLINT)
;
3
NULL

;
SELECT AVG(3::DOUBLE), AVG(NULL::DOUBLE)
;
3
NULL

# test average on sequence
;
CREATE SEQUENCE seq;

;
SELECT AVG(nextval('seq'))
;
1

;
SELECT AVG(nextval('seq'))
;
2

;
CREATE TABLE integers(i INTEGER);

;
INSERT INTO integers VALUES (1), (2), (3)

;
SELECT AVG(i), AVG(1), AVG(DISTINCT i), AVG(NULL) FROM integers
;
2
1
2
NULL

;
SELECT AVG(i) FROM integers WHERE i > 100
;
NULL

# invalid use of average
;
SELECT AVG()

;
SELECT AVG(1, 2, 3)

;
SELECT AVG(AVG(1))

# empty average
;
CREATE TABLE vals(i INTEGER, j DOUBLE, k HUGEINT);

;
INSERT INTO vals VALUES (NULL, NULL, NULL)

;
SELECT AVG(i), AVG(j), AVG(k) FROM vals;
;
NULL	NULL	NULL
