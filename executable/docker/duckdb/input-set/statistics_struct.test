# name: test/optimizer/statistics/statistics_struct.test
# description: Statistics propagation test with structs
# group: [statistics]

;
PRAGMA enable_verification;

;
CREATE TABLE structs AS SELECT {'i': i} c FROM range(4) tbl(i);

;
PRAGMA explain_output = OPTIMIZED_ONLY;

# we can statically determine IS NULL/IS NOT NULL are false, if there are no null values for this column
;
EXPLAIN SELECT c IS NULL FROM structs;
;
logical_opt	<!REGEX>:.*IS_NULL.*

# the same applies to c['i']
;
EXPLAIN SELECT c['i'] IS NULL FROM structs;
;
logical_opt	<!REGEX>:.*IS_NULL.*

# filter is out of range
;
EXPLAIN SELECT * FROM structs WHERE c['i']=4;
;
logical_opt	<REGEX>:.*EMPTY_RESULT.*
