# name: test/sql/storage/wal/wal_hugeint_storage.test
# description: Test HUGEINT with persistent storage with WAL
# group: [wal]

# load the DB from disk
load __TEST_DIR__/hugeint_storage_test.db

;
PRAGMA disable_checkpoint_on_shutdown

;
PRAGMA wal_autocheckpoint='1TB';

# create a table with hugeints
;
CREATE TABLE hugeints (h HUGEINT);

;
INSERT INTO hugeints VALUES (1043178439874412422424), (42), (NULL), (47289478944894789472897441242);

# reload the database from disk a few times, and check that the data is still there
loop i 0 2

restart

;
PRAGMA disable_checkpoint_on_shutdown

;
SELECT * FROM hugeints
;
1043178439874412422424
42
NULL
47289478944894789472897441242

;
SELECT * FROM hugeints WHERE h = 42
;
42

;
SELECT h FROM hugeints WHERE h < 10 ORDER BY 1;
;

endloop
