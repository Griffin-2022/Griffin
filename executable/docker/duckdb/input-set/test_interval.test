# name: test/sql/types/interval/test_interval.test
# description: Test basic interval usage
# group: [interval]

;
PRAGMA enable_verification

# 2 years
;
SELECT INTERVAL '2 years'
;
2 years

;
SELECT INTERVAL '2 years'::VARCHAR
;
2 years

# 2 years one minute
;
SELECT INTERVAL '2Y 1 M';
;
2 years 00:01:00

# 2 years 4 days one minute 3 seconds 20 milliseconds
;
SELECT INTERVAL '2Y 1 month 1 M 3S 20mS';
;
2 years 1 month 00:01:03.02

;
SELECT INTERVAL '2Y 1 month 02:01:03';
;
2 years 1 month 02:01:03

;
SELECT INTERVAL '2Y 1 month 1M 3S 20mS'::VARCHAR;
;
2 years 1 month 00:01:03.02

# -2 years +4 days +one minute 3 seconds 20 milliseconds
;
SELECT INTERVAL '-2Y 4 days 1 MinUteS 3S 20mS';
;
-2 years 4 days 00:01:03.02

;
SELECT INTERVAL '-2Y 4 days 1 MinUteS 3S 20mS'::VARCHAR;
;
-2 years 4 days 00:01:03.02

# test ago usage
;
SELECT INTERVAL '2Y 4 days 1 MinUteS 3S 20mS ago'::VARCHAR;
;
-2 years -4 days -00:01:03.02

;
SELECT INTERVAL '2Y 4 days 1 MinUteS 3S 20mS ago  '::VARCHAR;
;
-2 years -4 days -00:01:03.02

# months and hours, with optional @
;
SELECT INTERVAL '@2mons 1H';
;
2 months 01:00:00

# FIXME: we can also use the ISO 8601 interval format
;
SELECT INTERVAL 'P2MT1H1M';

# FIXME: or this format
;
SELECT INTERVAL 'P00-02-00T01:00:01';

;
SELECT INTERVAL '90' DAY;
;
90 days

;
SELECT INTERVAL '90' YEAR;
;
90 years

;
SELECT INTERVAL '90' MONTH;
;
7 years 6 months

;
SELECT INTERVAL '90' SECOND;
;
00:01:30

;
SELECT INTERVAL '90' MINUTE;
;
01:30:00

;
SELECT INTERVAL '90' HOUR;
;
90:00:00

# we can add together intervals
;
SELECT INTERVAL '2 month' + INTERVAL '1 month 3 days';
;
3 months 3 days

# or subtract them
;
SELECT INTERVAL '2 month' - INTERVAL '1 month 3 days';
;
1 month -3 days

# but not multiply
;
SELECT INTERVAL '2 month' * INTERVAL '1 month 3 days';

# we can, however, multiply/divide intervals by integers
;
SELECT INTERVAL '1 year 2 days 2 seconds' * 2;
;
2 years 4 days 00:00:04

# multiplication can be done both ways
;
SELECT 2 * INTERVAL '1 year 2 days 2 seconds';
;
2 years 4 days 00:00:04

;
SELECT INTERVAL '1 year 2 days 2 seconds' / 2;
;
6 months 1 day 00:00:01

# division cannot!
;
SELECT 2 / INTERVAL '1 year 2 days 2 seconds';

# division by zero
;
SELECT INTERVAL '1 year 2 days 2 seconds' / 0;
;
NULL

# invalid intervals
# empty interval
;
SELECT INTERVAL '';

;
SELECT INTERVAL '   	';

# no number
;
SELECT INTERVAL 'years';

;
SELECT INTERVAL '-years';

# gibberish
;
SELECT INTERVAL 'aergjaerghiuaehrgiuhaerg';

# overflow in year
;
SELECT INTERVAL '100000000000000000year';

# overflow in months
;
SELECT INTERVAL '100000000000000000months';

;
SELECT INTERVAL '4294967296months';

;
SELECT INTERVAL '1294967296months';
;
107913941 years 4 months

;
SELECT INTERVAL '1294967296months 1294967296months';

;
SELECT INTERVAL '1294967296months -1294967296months';
;
00:00:00

;
SELECT INTERVAL '-1294967296months -1294967296months';

# overflow in days
;
SELECT INTERVAL '100000000000000000days';

;
SELECT INTERVAL '1294967296days 1294967296days';

# overflow in micro seconds
;
SELECT INTERVAL '100000000000000000000msecs';

;
SELECT INTERVAL '100000000000000000hours';

;
SELECT INTERVAL '2562047788 hours';
;
2562047788:00:00

;
SELECT INTERVAL '2562047788 hours 2562047788 hours';

;
SELECT INTERVAL '-9223372036854775msecs';
;
-2562047788:00:54.775

;
SELECT INTERVAL '9223372036854775msecs';
;
2562047788:00:54.775

;
SELECT INTERVAL '1 week';
;
7 days

;
SELECT INTERVAL '1 millennium 2 centuries 1 decade 3 quarter';
;
1210 years 9 months


;
SELECT INTERVAL '-2147483647 months -2147483647 days -9223372036854775msecs';
;
-178956970 years -7 months -2147483647 days -2562047788:00:54.775

;
SELECT INTERVAL '2147483647 months 2147483647 days 9223372036854775msecs';
;
178956970 years 7 months 2147483647 days 2562047788:00:54.775

;
SELECT INTERVAL '9223372036854775810msecs';

;
SELECT INTERVAL '-9223372036854775810msecs';

# need a number here
;
SELECT INTERVAL 'aa' DAY;

;
SELECT INTERVAL '100 months' DAY;

;
SELECT '100'::INTERVAL;

;
SELECT '100 unknowns'::INTERVAL;

;
SELECT '100 months a'::INTERVAL;

;
SELECT '100 months axo'::INTERVAL;

;
SELECT '100 months agb'::INTERVAL;

;
SELECT '100 months agob'::INTERVAL;
