# name: test/sql/function/list/aggregates/mode.test
# description: Test the list_mode aggregate function
# group: [aggregates]

# incorrect usage
;
select list_mode()

# integers
;
CREATE TABLE range AS SELECT LIST(2) AS i FROM range(100) t1(i)

;
SELECT list_mode(i) FROM range;
;
2

# strings
;
create table names (name string[])

;
insert into names values (['pedro', 'pedro', 'pedro', 'hannes', 'hannes', 'mark', NULL]);

;
select list_mode(name) from names;
;
pedro

require vector_size 512

# temporal types

# date
;
create table dates (v date[])

;
insert into dates values (['2021-05-02', '2021-05-02', '2021-05-02', '2020-02-29', '2020-02-29', '2004-09-01', NULL]);

;
select list_mode(v) from dates;
;
2021-05-02

# time
;
create table times (v time[])

;
insert into times values (['12:11:49.5', '12:11:49.5', '12:11:49.5', '06:30:00', '06:30:00', '21:15:22', NULL]);

;
select list_mode(v) from times;
;
12:11:49.5

# timestamp
;
create table timestamps (v timestamp[])

;
insert into timestamps values (['2021-05-02 12:11:49.5', '2021-05-02 12:11:49.5', '2021-05-02 12:11:49.5',
    '2020-02-29 06:30:00', '2020-02-29 06:30:00', '2004-09-01 21:15:22', NULL]);

;
select list_mode(v) from timestamps;
;
2021-05-02 12:11:49.5

# interval
;
create table intervals (v interval[])

;
insert into intervals values
    ([INTERVAL '5 months 2 days 12 hours 11 minutes 49 seconds',
    INTERVAL '5 months 2 days 12 hours 11 minutes 49 seconds',
    INTERVAL '5 months 2 days 12 hours 11 minutes 49 seconds',
    INTERVAL '2 months 29 days 6 hours 30 minutes',
    INTERVAL '2 months 29 days 6 hours 30 minutes',
    INTERVAL '9 months 1 day 21 hours 15 minutes 22 seconds',
    NULL]);

;
select list_mode(v) from intervals;
;
5 months 2 days 12:11:49

# huge integers
;
create table hugeints (v hugeint[])

;
insert into hugeints values ([5, 5, 5, 2, 2, 1, NULL]);

;
select list_mode(v) from hugeints;
;
5

# decimals
;
create table aggr (v decimal(10,2)[]);

;
insert into aggr values ([10, 10, 20, 21]), ([20, 20, 25, 30]), ([NULL]), ([]), (NULL);

;
select list_mode(v) from aggr;
;
10
20
NULL
NULL
NULL