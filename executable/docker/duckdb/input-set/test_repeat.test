# name: test/sql/function/string/test_repeat.test
# description: REPEAT test
# group: [string]

;
PRAGMA enable_verification

# test repeat on NULLs
;
select REPEAT(NULL, NULL), REPEAT(NULL, 3), REPEAT('MySQL', NULL)
;
NULL	NULL	NULL

# test repeat on scalars
;
select REPEAT('', 3), REPEAT('MySQL', 3), REPEAT('MotörHead', 2), REPEAT('Hello', -1)
;
(empty)	MySQLMySQLMySQL	MotörHeadMotörHead	(empty)

# test repeat on tables
;
CREATE TABLE strings(a STRING, b STRING)

;
INSERT INTO strings VALUES ('Hello', 'World'), ('HuLlD', NULL), ('MotörHead','RÄcks'), ('', NULL)

;
select REPEAT(a, 3) FROM strings
;
HelloHelloHello
HuLlDHuLlDHuLlD
MotörHeadMotörHeadMotörHead
(empty)

;
select REPEAT(b, 2) FROM strings
;
WorldWorld
NULL
RÄcksRÄcks
NULL

;
select REPEAT(a, 4) FROM strings WHERE b IS NOT NULL
;
HelloHelloHelloHello
MotörHeadMotörHeadMotörHeadMotörHead

# test incorrect usage of reverse
;
select REPEAT()

;
select REPEAT(1)

;
select REPEAT('hello', 'world')

;
select REPEAT('hello', 'world', 3)

