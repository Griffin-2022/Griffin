# name: test/sql/index/art/test_art_index_join.test
# description: ART Join
# group: [art]

;
PRAGMA enable_verification

;
CREATE TABLE Person (id bigint PRIMARY KEY);

;
CREATE TABLE Person_knows_Person (Person1id bigint, Person2id bigint);

;
INSERT INTO Person VALUES (1), (2), (3), (4), (5);

;
INSERT INTO Person_knows_Person VALUES (1, 2), (1, 3), (1, 4), (2, 3), (3, 4), (4, 5);

;
PRAGMA force_index_join;

;
SELECT p1.id
FROM Person_knows_Person pkp
JOIN Person p1
  ON p1.id = pkp.Person1id
;
1
1
1
2
3
4

;
SELECT p1.id,p2.id
FROM Person_knows_Person pkp
JOIN Person p1
  ON p1.id = pkp.Person1id
JOIN Person p2
  ON p2.id = pkp.Person2id;
;
1	2
1	3
1	4
2	3
3	4
4	5
