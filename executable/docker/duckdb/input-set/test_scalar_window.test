# name: test/sql/window/test_scalar_window.test
# description: Most scalar window functions
# group: [window]

require vector_size 512

;
PRAGMA enable_verification

# test scalar window functions
;
SELECT row_number() OVER ()
;
1

;
SELECT avg(42) OVER ()
;
42.000000

# window on non-aggregate function
;
SELECT concat() OVER ()

;
SELECT nonexistingfunction() OVER ()

# nested window functions are not allowed
;
SELECT avg(row_number() over ()) over ()

;
SELECT avg(42) over (partition by row_number() over ())

;
SELECT avg(42) over (order by row_number() over ())

# distinct aggregates not supported for window functions
;
SELECT COUNT(DISTINCT 42) OVER ()

;
WITH t AS (SELECT col0 AS a, col1 AS b FROM (VALUES(1,2),(1,1),(1,2),(2,1),(2,1),(2,2),(2,3),(2,4)) v) SELECT *, COUNT(b) OVER(PARTITION BY a), COUNT(DISTINCT b) OVER(PARTITION BY a) FROM t;

