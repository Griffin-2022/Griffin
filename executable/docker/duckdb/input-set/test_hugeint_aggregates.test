# name: test/sql/types/hugeint/test_hugeint_aggregates.test
# description: Test hugeint aggregates
# group: [hugeint]

;
PRAGMA enable_verification

;
CREATE TABLE hugeints(g INTEGER, h HUGEINT);

;
INSERT INTO hugeints VALUES (1, 42.0), (2, 1267650600228229401496703205376), (2, -439847238974238975238975), (1, '-12');

# min, max, first, sum
# ungrouped aggregate
;
SELECT MIN(h), MAX(h), SUM(h), FIRST(h), LAST(h) FROM hugeints;
;
-439847238974238975238975	1267650600228229401496703205376	1267650160380990427257727966431	42	-12

# grouped aggregate
;
SELECT g, MIN(h), MAX(h), SUM(h), FIRST(h), LAST(h) FROM hugeints GROUP BY g ORDER BY 1;
;
1	-12	42	30	42	-12
2	-439847238974238975238975	1267650600228229401496703205376	1267650160380990427257727966401	1267650600228229401496703205376	-439847238974238975238975

# first aggr gets confused otherwise
;
PRAGMA threads=1

# ungrouped aggregate
;
SELECT FIRST(h), LAST(h) FROM hugeints;
;
42	-12

# grouped aggregate
;
SELECT g, FIRST(h), LAST(h) FROM hugeints GROUP BY g ORDER BY 1;
;
1	42	-12
2	1267650600228229401496703205376	-439847238974238975238975

