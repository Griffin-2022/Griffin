# name: test/sql/types/hugeint/hugeint_multiply.test
# description: Test correct computation of hugeint multiplication
# group: [hugeint]

# overflows of various parts of the multiplication
# hugeint multiplication is done in 4 segments (low bits & high bits of the lower and upper int64 part)
# we test all combinations here
# 251658240           =                  [low, low]
# 1080863910568919040 =                  [low, high]
# 4642275147320176030871715840           [high, low]
# 19938419936773738093557105904205168640 [high, high]

# [low, low] mult
;
SELECT 251658240::HUGEINT * 251658240::HUGEINT
;
63331869759897600

;
SELECT 251658240::HUGEINT * 1080863910568919040::HUGEINT
;
272008309413291564308889600

;
SELECT 251658240::HUGEINT * 4642275147320176030871715840::HUGEINT
;
1168266793170336216419361674074521600

;
SELECT 251658240::HUGEINT * 19938419936773738093557105904205168640::HUGEINT

# [low, high]
;
SELECT 1080863910568919040::HUGEINT * 251658240::HUGEINT
;
272008309413291564308889600

;
SELECT 1080863910568919040::HUGEINT * 1080863910568919040::HUGEINT
;
1168266793170336216419361674074521600

;
SELECT 1080863910568919040::HUGEINT * 4642275147320176030871715840::HUGEINT

;
SELECT 1080863910568919040::HUGEINT * 19938419936773738093557105904205168640::HUGEINT

# [high, low]
;
SELECT 4642275147320176030871715840::HUGEINT * 251658240::HUGEINT
;
1168266793170336216419361674074521600

;
SELECT 4642275147320176030871715840::HUGEINT * 1080863910568919040::HUGEINT

;
SELECT 4642275147320176030871715840::HUGEINT * 4642275147320176030871715840::HUGEINT

;
SELECT 4642275147320176030871715840::HUGEINT * 19938419936773738093557105904205168640::HUGEINT

# [high, high]
;
SELECT 19938419936773738093557105904205168640::HUGEINT * 251658240::HUGEINT

;
SELECT 19938419936773738093557105904205168640::HUGEINT * 1080863910568919040::HUGEINT

;
SELECT 19938419936773738093557105904205168640::HUGEINT * 4642275147320176030871715840::HUGEINT

;
SELECT 19938419936773738093557105904205168640::HUGEINT * 19938419936773738093557105904205168640::HUGEINT

# more overflow tests on the boundaries
;
SELECT 85070591730234615865843651857942052863::HUGEINT * 2::HUGEINT
;
170141183460469231731687303715884105726

;
SELECT 85070591730234615865843651857942052864::HUGEINT * 2::HUGEINT

;
SELECT 85070591730234615865843651857942052865::HUGEINT * 2::HUGEINT

;
SELECT 19807040628566084398385987583::HUGEINT * 8589934592::HUGEINT
;
170141183460469231731687303707294171136

;
SELECT 19807040628566084398385987584::HUGEINT*8589934592::HUGEINT;

;
SELECT 36893488147419103231::HUGEINT * 4611686018427387904::HUGEINT
;
170141183460469231727075617697456717824

;
SELECT 36893488147419103232::HUGEINT * 4611686018427387904::HUGEINT

# now reverse sides
;
SELECT 2::HUGEINT * 85070591730234615865843651857942052863::HUGEINT
;
170141183460469231731687303715884105726

;
SELECT 2::HUGEINT * 85070591730234615865843651857942052864::HUGEINT

;
SELECT 2::HUGEINT * 85070591730234615865843651857942052865::HUGEINT

;
SELECT 8589934592::HUGEINT * 19807040628566084398385987583::HUGEINT
;
170141183460469231731687303707294171136

;
SELECT 8589934592::HUGEINT * 19807040628566084398385987584::HUGEINT

;
SELECT 4611686018427387904::HUGEINT * 36893488147419103231::HUGEINT
;
170141183460469231727075617697456717824

;
SELECT 4611686018427387904::HUGEINT * 36893488147419103232::HUGEINT

;
SELECT 10376293541461622783::HUGEINT * 10376293541461622783::HUGEINT
;
107667467658578185684455784799784665089

;
SELECT 10376293541461622783::HUGEINT * 10376293541461622783::HUGEINT
;
107667467658578185684455784799784665089

;
SELECT 17293822569102704639::HUGEINT * 10376293541461622783::HUGEINT
