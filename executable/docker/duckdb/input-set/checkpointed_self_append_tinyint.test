# name: test/sql/storage/checkpointed_self_append_tinyint.test
# description: Test appending to a checkpointed table from itself with tinyint columns
# group: [storage]

# load the DB from disk
load __TEST_DIR__/checkpointed_self_append.db

;
CREATE TABLE vals(i TINYINT)

;
INSERT INTO vals SELECT (CASE WHEN i % 2 = 0 THEN NULL ELSE i % 100 END)::TINYINT i FROM range(200000) tbl(i)

;
SELECT MIN(i), MAX(i), COUNT(i), COUNT(*) FROM vals
;
1	99	100000	200000

;
CHECKPOINT

;
SELECT MIN(i), MAX(i), COUNT(i), COUNT(*) FROM vals
;
1	99	100000	200000

;
INSERT INTO vals SELECT * FROM vals;
;
200000

;
SELECT MIN(i), MAX(i), COUNT(i), COUNT(*) FROM vals
;
1	99	200000	400000
