# name: test/sql/projection/select_star_replace.test
# description: SELECT * REPLACE
# group: [projection]

;
PRAGMA enable_verification

;
CREATE TABLE integers(i INTEGER, j INTEGER, k INTEGER)

;
INSERT INTO integers VALUES (1, 2, 3)

;
SELECT * REPLACE i+100 AS i FROM integers
;
101	2	3

;
SELECT * EXCLUDE (j, k) REPLACE (i+100 AS i), * EXCLUDE (j) REPLACE (i+100 AS i), * EXCLUDE (j, k) REPLACE (i+101 AS i) FROM integers
;
101	101	3	102

;
SELECT * REPLACE (i+100 AS i, j+200 AS "J") FROM integers
;
101	202	3

;
SELECT integers.* REPLACE (i+100 AS i) FROM integers
;
101	2	3

# duplicate entry in replace list
;
SELECT * REPLACE (i+100 AS i, i+200 AS i) FROM integers

# replace name that does not exist
;
SELECT * REPLACE (i+100 AS blabla) FROM integers

;
SELECT integers.* REPLACE (i+100 AS blabla) FROM integers

# column cannot occur in both exclude and replace list
;
SELECT * EXCLUDE (i) REPLACE (i+100 AS i) FROM integers
