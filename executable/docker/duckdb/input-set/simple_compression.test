# name: test/sql/storage/compression/simple_compression.test
# description: Test storage with multiple compression schemes
# group: [compression]

# load the DB from disk
load __TEST_DIR__/test_compression_simple.db

foreach compression <compression>

;
PRAGMA force_compression = '${compression}'

# simple compression with few values
;
CREATE TABLE test (a INTEGER, b INTEGER);

;
INSERT INTO test VALUES (11, 22), (11, 22), (12, 21), (NULL, NULL)

;
SELECT SUM(a), SUM(b) FROM test
;
34	65

restart

;
SELECT SUM(a), SUM(b) FROM test
;
34	65

;
DROP TABLE test

endloop
