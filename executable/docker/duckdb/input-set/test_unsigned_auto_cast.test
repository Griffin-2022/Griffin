# name: test/sql/types/unsigned/test_unsigned_auto_cast.test
# description: Test unsigned auto cast
# group: [unsigned]

;
PRAGMA enable_verification

## test auto cast of unsigned
#query I
#SELECT 100000000::INTEGER + 100::UTINYINT
#----
#100000100

# test auto cast of UTINYINT -> DOUBLE
;
SELECT 200::UTINYINT + 0.5
;
200.5

;
SELECT COS(100::UTINYINT)
;
0.862318872287684

# test auto cast of UTINYINT -> VARCHAR
;
SELECT CONCAT('hello number ', 100::UTINYINT)
;
hello number 100



# test auto cast of integer types to USMALLINT
;
SELECT 100000000::INTEGER + 100::USMALLINT
;
100000100

# test auto cast of USMALLINT -> DOUBLE
;
SELECT 100::USMALLINT + 0.5
;
100.5

;
SELECT COS(100::USMALLINT)
;
0.862318872287684

# test auto cast of USMALLINT -> VARCHAR
;
SELECT CONCAT('hello number ', 100::USMALLINT)
;
hello number 100


# test auto cast of  integer types to UINTEGER
;
SELECT 100000000::INTEGER + 100::UINTEGER
;
100000100

# test auto cast of UINTEGER -> DOUBLE
;
SELECT 100::UINTEGER + 0.5
;
100.5

;
SELECT COS(100::UINTEGER)
;
0.862318872287684

# test auto cast of UINTEGER -> VARCHAR
;
SELECT CONCAT('hello number ', 100::UINTEGER)
;
hello number 100


# test auto cast of  integer types to UBIGINT
;
SELECT 100000000::INTEGER + 100::UBIGINT
;
100000100

# test auto cast of UBIGINT -> DOUBLE
;
SELECT 100::UBIGINT + 0.5
;
100.5

;
SELECT COS(100::UBIGINT)
;
0.862318872287684

# test auto cast of UBIGINT -> VARCHAR
;
SELECT CONCAT('hello number ', 100::UBIGINT)
;
hello number 100


# Tests on string -> unsigned
;
SELECT '255'::UTINYINT;
;
255

;
SELECT '256'::UTINYINT;

;
SELECT '255'::USMALLINT;
;
255

;
SELECT '65536'::USMALLINT;

;
SELECT '65535'::UINTEGER;
;
65535

;
SELECT '4294967296'::UINTEGER;

;
SELECT '4294967295'::UBIGINT;
;
4294967295

;
SELECT '18446744073709551616'::UBIGINT;

;
SELECT '18446744073709551615'::UBIGINT;
;
18446744073709551615


# More tests with decimals
;
SELECT (100::UTINYINT)::DECIMAL(3,0);
;
100

;
SELECT (100::UTINYINT)::DECIMAL(2,0);

;
SELECT 100::UTINYINT * 100::DECIMAL(3,0);
;
10000

;
SELECT (100::USMALLINT)::DECIMAL(3,0);
;
100

;
SELECT (100::USMALLINT)::DECIMAL(2,0);

;
SELECT 100::USMALLINT * 100::DECIMAL(3,0);
;
10000


;
SELECT (100::UINTEGER)::DECIMAL(3,0);
;
100

;
SELECT (100::UINTEGER)::DECIMAL(2,0);

;
SELECT 100::UINTEGER * 100::DECIMAL(3,0);
;
10000

;
SELECT (100::UBIGINT)::DECIMAL(3,0);
;
100

;
SELECT (100::UBIGINT)::DECIMAL(2,0);

;
SELECT 100::UBIGINT * 100::DECIMAL(3,0);
;
10000