# name: test/sql/aggregate/aggregates/test_kurtosis.test
# description: Test kurtosis aggregate
# group: [aggregates]

#Corner cases
;
select kurtosis()

;
select kurtosis(NULL)
;
NULL

;
select kurtosis(1)
;
NULL

;
select kurtosis(*)

;
select kurtosis(i) from (values (0), (0), (0), (0), (0), (0)) tbl(i)
;
NULL

# out of range
;
select kurtosis(i) from (values (2e304), (2e305), (2e306), (2e307)) tbl(i)

# Constant Value (This should be an error)
;
select kurtosis(10) from range (5)
;
NULL

#Empty Table
;
select kurtosis(10) from range (5) where 1 == 0
;
NULL

;
create table aggr(k int, v int, v2 int);

;
insert into aggr values
    (1, 10, null),
    (2, 10, 11),
    (2, 10, 15),
    (2, 10, 18),
    (2, 20, 22),
    (2, 20, 25),
    (2, 25, null),
    (2, 30, 35),
    (2, 30, 40),
    (2, 30, 50),
    (2, 30, 51);

;
select kurtosis(k), kurtosis(v), kurtosis(v2) from aggr;
;
11.000000	-1.961428	-1.445120

;
select  kurtosis(v2) from aggr group by v;
;
NULL
NULL
NULL
-3.977599

# Window Function
require vector_size 512

;
select kurtosis(v2) over (partition by v)
    from aggr;
;
-3.977599
-3.977599
-3.977599
-3.977599
NULL
NULL
NULL
NULL
NULL
NULL
NULL
