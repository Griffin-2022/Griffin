# name: test/sql/parallelism/intraquery/parallel_sample.test
# description: Test parallel reservoir sampling
# group: [intraquery]

;
PRAGMA enable_verification

;
PRAGMA threads=4

;
PRAGMA verify_parallelism

;
PRAGMA enable_profiling

;
PRAGMA profiling_output='__TEST_DIR__/test.json'

;
PRAGMA profiling_mode = detailed

;
CREATE TABLE integers AS SELECT * FROM range(50000) tbl(i)

loop i 0 3

;
SELECT COUNT(*) FROM integers TABLESAMPLE RESERVOIR(100)
;
100

endloop
