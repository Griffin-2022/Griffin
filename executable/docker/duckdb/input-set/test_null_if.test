# name: test/sql/function/generic/test_null_if.test
# description: Test NULL IF statement
# group: [generic]

;
PRAGMA enable_verification

# NULL IF
;
SELECT NULLIF(NULLIF ('hello', 'world'), 'blabla');
;
hello

# NULL IF with subquery
;
CREATE TABLE test (a STRING);

;
INSERT INTO test VALUES ('hello'), ('world'), ('test')

;
CREATE TABLE test2 (a STRING, b STRING);

;
INSERT INTO test2 VALUES ('blabla', 'b'), ('blabla2', 'c'), ('blabla3', 'd')

;
SELECT NULLIF(NULLIF ((SELECT a FROM test LIMIT 1 offset 1), a), b) FROM test2
;
world
world
world

;
DROP TABLE test;

# NULL IF with strings
;
CREATE TABLE test3 (a INTEGER, b INTEGER);

;
INSERT INTO test3 VALUES (11, 22), (13, 22), (12, 21)

;
SELECT NULLIF(CAST(a AS VARCHAR), 11) FROM test3;
;
NULL
13
12

;
SELECT a, CASE WHEN a>11 THEN CAST(a AS VARCHAR) ELSE CAST(b AS VARCHAR) END FROM test3 ORDER BY 1;
;
11	22
12	12
13	13

