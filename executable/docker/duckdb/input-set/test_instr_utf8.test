# name: test/sql/function/string/test_instr_utf8.test
# description: Instr test with UTF8
# group: [string]

;
PRAGMA enable_verification

;
CREATE TABLE strings(s VARCHAR);

;
INSERT INTO strings VALUES ('Ã¡tomo')

;
INSERT INTO strings VALUES ('olÃ¡ mundo')

;
INSERT INTO strings VALUES ('ä½ å¥½ä¸–ç•Œ')

;
INSERT INTO strings VALUES ('two Ã± three â‚¡ four ðŸ¦† end')

# Test one matching UTF8 letter
;
SELECT INSTR(s,'Ã¡') FROM strings
;
1
3
0
0

;
SELECT POSITION('Ã¡' in s) FROM strings
;
1
3
0
0

# Test a sentence with UTF-8
;
SELECT INSTR(s,'olÃ¡ mundo') FROM strings
;
0
1
0
0

# Test an entire UTF-8 word
;
SELECT INSTR(s,'ä½ å¥½ä¸–ç•Œ') FROM strings
;
0
0
1
0

# Test a substring of the haystack from the beginning
;
SELECT instr(s,'two Ã± thr') FROM strings
;
0
0
0
1

# Test a single UTF8 substring of the haystack in the middle
;
SELECT instr(s,'Ã±') FROM strings
;
0
0
0
5

# Test a multiple UTF8 substring of the haystack in the middle
;
SELECT instr(s,'â‚¡ four ðŸ¦† e') FROM strings
;
0
0
0
13

# Test a substring of the haystack from the middle to the end
;
SELECT instr(s,'ðŸ¦† end') FROM strings
;
0
0
0
20

