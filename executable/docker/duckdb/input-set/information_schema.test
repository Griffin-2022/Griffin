# name: test/sql/table_function/information_schema.test
# description: Test information_schema functions
# group: [table_function]

;
SELECT * FROM INFORMATION_SCHEMA.SCHEMATA;

;
SELECT * FROM information_schema.schemata;

;
CREATE SCHEMA scheme;

;
SELECT COUNT(*) FROM information_schema.schemata WHERE schema_name='scheme'
;
1

;
CREATE TABLE scheme.integers (i INTEGER);

;
SELECT table_type FROM information_schema.tables WHERE table_schema='scheme' AND table_name='integers'
;
BASE TABLE

;
SELECT ordinal_position, column_name, data_type FROM information_schema.columns WHERE table_name='integers'
;
1	i	INTEGER

;
SELECT ordinal_position, column_name, data_type FROM information_schema.columns WHERE table_name='integers'
;
1	i	INTEGER

;
CREATE TEMPORARY TABLE reals (f FLOAT PRIMARY KEY, dec DECIMAL(16, 4), h HUGEINT, b BIGINT, t TINYINT, d DOUBLE NOT NULL)

;
SELECT table_type FROM information_schema.tables WHERE table_schema='temp' AND table_name='reals'
;
LOCAL TEMPORARY

;
SELECT numeric_precision, numeric_scale, is_nullable FROM information_schema.columns WHERE table_name='reals' ORDER BY ordinal_position
;
24	0	NO
16	4	YES
128	0	YES
64	0	YES
8	0	YES
53	0	NO

;
CREATE VIEW scheme.vintegers AS SELECT * FROM scheme.integers;

;
SELECT table_type FROM information_schema.tables WHERE table_schema='scheme' AND table_name='vintegers'
;
VIEW

;
SELECT table_type FROM information_schema.tables WHERE table_schema='scheme' AND table_name='vintegers'
;
VIEW

;
SELECT ordinal_position, column_name, data_type FROM information_schema.columns WHERE table_schema='scheme' AND table_name='vintegers'
;
1	i	INTEGER

;
DROP SCHEMA scheme CASCADE;

;
SELECT COUNT(*) FROM information_schema.schemata WHERE schema_name='scheme'
;
0

;
SELECT COUNT(*) FROM information_schema.tables WHERE table_schema='scheme'
;
0

;
SELECT COUNT(*) FROM information_schema.columns WHERE table_schema='scheme'
;
0
