# name: test/sql/topn/test_top_n.test
# description: Test Top N Optimization
# group: [topn]

;
PRAGMA enable_verification

;
CREATE TABLE test (b INTEGER);

;
INSERT INTO test VALUES (22), (2), (7);

# Top N optimization
;
SELECT b FROM test ORDER BY b DESC LIMIT 2;
;
22
7

# Top N optimization: works with OFFSET
;
SELECT b FROM test ORDER BY b LIMIT 1 OFFSET 1;
;
7

# Top N optimization: Limit greater than number of rows
;
SELECT b FROM test ORDER BY b LIMIT 10 OFFSET 1;
;
7
22

# Top N optimization: Offset greater than total number of rows
;
SELECT b FROM test ORDER BY b LIMIT 10 OFFSET 10;
;

# Top N optimization: doesn't apply for Offset without Limit
;
SELECT b FROM test ORDER BY b OFFSET 10;
;

