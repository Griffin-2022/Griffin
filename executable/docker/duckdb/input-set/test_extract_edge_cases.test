# name: test/sql/function/date/test_extract_edge_cases.test
# description: Extract function edge cases
# group: [date]

# century changes in the year 1
;
SELECT EXTRACT(century FROM cast('2000-10-10' AS DATE));
;
20

;
SELECT EXTRACT(century FROM cast('2001-10-10' AS DATE));
;
21

# millennium changes in the year 1
;
SELECT EXTRACT(millennium FROM cast('2000-10-10' AS DATE));
;
2

;
SELECT EXTRACT(millennium FROM cast('2001-10-10' AS DATE));
;
3

# check DOW
# start from the epoch and go up/down, every time the day should go up/down
# one as well
;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) + 0);
;
4

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) - 0);
;
4

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) + 1);
;
5

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) - 1);
;
3

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) + 2);
;
6

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) - 2);
;
2

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) + 3);
;
0

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) - 3);
;
1

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) + 4);
;
1

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) - 4);
;
0

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) + 5);
;
2

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) - 5);
;
6

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) + 6);
;
3

;
SELECT EXTRACT(dow FROM cast('1970-01-01' AS DATE) - 6);
;
5

;
SELECT EXTRACT(dow FROM cast('1793-05-26' AS DATE));
;
0

;
SELECT EXTRACT(isodow FROM cast('1793-05-26' AS DATE));
;
7

# week numbers are weird
;
SELECT EXTRACT(week FROM cast('2005-01-01' AS DATE));
;
53

;
SELECT EXTRACT(week FROM cast('2006-01-01' AS DATE));
;
52

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE));
;
1

;
SELECT EXTRACT(week FROM cast('2008-01-01' AS DATE));
;
1

;
SELECT EXTRACT(week FROM cast('2009-01-01' AS DATE));
;
1

;
SELECT EXTRACT(week FROM cast('2010-01-01' AS DATE));
;
53

# every 7 days the week number should go up by 7
;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 0);
;
1

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 7);
;
2

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 14);
;
3

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 21);
;
4

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 28);
;
5

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 35);
;
6

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 42);
;
7

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 49);
;
8

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 56);
;
9

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 63);
;
10

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 70);
;
11

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 77);
;
12

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 84);
;
13

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 91);
;
14

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 98);
;
15

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 105);
;
16

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 112);
;
17

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 119);
;
18

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 126);
;
19

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 133);
;
20

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 140);
;
21

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 147);
;
22

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 154);
;
23

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 161);
;
24

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 168);
;
25

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 175);
;
26

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 182);
;
27

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 189);
;
28

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 196);
;
29

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 203);
;
30

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 210);
;
31

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 217);
;
32

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 224);
;
33

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 231);
;
34

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 238);
;
35

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 245);
;
36

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 252);
;
37

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 259);
;
38

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 266);
;
39

;
SELECT EXTRACT(week FROM cast('2007-01-01' AS DATE) + 273);
;
40

