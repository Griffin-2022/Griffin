# name: test/sql/catalog/test_standard_schema.test
# description: Schema creation/deletion
# group: [catalog]

# cannot drop MAIN schema
;
DROP SCHEMA main CASCADE;

# create and drop an empty schema
;
CREATE SCHEMA test;

;
DROP SCHEMA test;

# create the schema again
;
CREATE SCHEMA test;

# duplicate schema
;
CREATE SCHEMA test;

# if not exists ignores error
;
CREATE SCHEMA IF NOT EXISTS test;

# create table inside schema that exists should succeed
;
CREATE TABLE test.hello(i INTEGER);

# create table inside schema that does not exist should fail
;
CREATE TABLE test2.hello(i INTEGER);

# use the table in queries
# insert into table
;
INSERT INTO test.hello VALUES (2), (3), (4)

# select from table without schema specified should fail
;
SELECT * FROM hello

# with schema specified should succeed
;
SELECT * FROM test.hello
;
2
3
4

# drop schema with dependencies should fail
;
DROP SCHEMA test;

# unless we use cascade to drop
;
DROP SCHEMA test CASCADE;

# drop schema if exists should not fail if schema does not exist
;
DROP SCHEMA IF EXISTS test;

# but drop schema without it should fail
;
DROP SCHEMA test;

