# name: test/sql/function/timestamp/test_extract.test
# description: Extract timestamp function
# group: [timestamp]

;
PRAGMA enable_verification

;
CREATE TABLE timestamps(i TIMESTAMP)

;
INSERT INTO timestamps VALUES ('1993-08-14 08:22:33'), (NULL)

# extract various parts of the timestamp
;
SELECT EXTRACT(year FROM i) FROM timestamps
;
1993
NULL

;
SELECT EXTRACT(month FROM i) FROM timestamps
;
8
NULL

;
SELECT EXTRACT(day FROM i) FROM timestamps
;
14
NULL

;
SELECT EXTRACT(week FROM i) FROM timestamps
;
32
NULL

;
SELECT EXTRACT(yearweek FROM i) FROM timestamps
;
199332
NULL

;
SELECT EXTRACT(quarter FROM i) FROM timestamps
;
3
NULL

;
SELECT EXTRACT(decade FROM i) FROM timestamps
;
199
NULL

;
SELECT EXTRACT(century FROM i) FROM timestamps
;
20
NULL

# day of the week (Sunday = 0, Saturday = 6)
;
SELECT EXTRACT(DOW FROM i) FROM timestamps
;
6
NULL

# day of the year (1 - 365/366)
;
SELECT EXTRACT(DOY FROM i) FROM timestamps
;
226
NULL

;
SELECT EXTRACT(epoch FROM i) FROM timestamps
;
745316553
NULL

# isodow (Monday = 1, Sunday = 7)
;
SELECT EXTRACT(ISODOW FROM i) FROM timestamps
;
6
NULL

# millennium (change of millennium is January 1, X001)
;
SELECT EXTRACT(millennium FROM i) FROM timestamps
;
2
NULL

;
SELECT EXTRACT(second FROM i) FROM timestamps
;
33
NULL

;
SELECT EXTRACT(minute FROM i) FROM timestamps
;
22
NULL

;
SELECT EXTRACT(hour FROM i) FROM timestamps
;
8
NULL

;
SELECT EXTRACT(milliseconds FROM i) FROM timestamps
;
33000
NULL

