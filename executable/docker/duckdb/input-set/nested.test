# name: test/sql/function/list/aggregates/nested.test
# description: Test nested list functions
# group: [aggregates]

;
SELECT list_min(list_concat([1, 2], [-1]))
;
-1

;
SELECT list_min(list_aggr([1, 2], 'list'))
;
1

;
CREATE TABLE lists (l1 INTEGER[], l2 INTEGER[])

;
INSERT INTO lists VALUES ([1, 2, 3], [4]), ([NULL, 1, -4, NULL], [NULL]), (NULL, NULL), ([NULL], [-4]), ([], [])

;
SELECT list_last(list_concat(l1, l2)) FROM lists
;
4
NULL
NULL
-4
NULL

;
SELECT list_concat(list(list_last(l1)), list(list_first(l2))) FROM lists
;
[3, NULL, NULL, NULL, NULL, 4, NULL, NULL, -4, NULL]

# aliases
;
SELECT array_aggregate([1, 2], 'min')
;
1

;
SELECT array_aggr([1, 2], 'min')
;
1

;
SELECT list_aggregate([1, 2], 'min')
;
1