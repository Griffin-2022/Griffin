# name: test/sql/function/list/aggregates/entropy.test
# description: Test the list_entropy aggregate function
# group: [aggregates]

# incorrect usage
;
select list_entropy()

;
select list_entropy([1])
;
0

;
create table aggr(k int[]);

;
insert into aggr values ([0, 1, 1, 1, 4, 0, 3, 3, 2, 2, 4, 4, 2, 4, 0, 0, 0, 1, 2, 3, 4, 2, 3, 3, 1]);

;
insert into aggr values ([]), ([NULL]), (NULL), ([0, 1, 1, 1, 4, NULL, 0, 3, 3, 2, NULL, 2, 4, 4, 2, 4, 0, 0, 0, 1, NULL, 2, 3, 4, 2, 3, 3, 1]);

;
select list_entropy(k) from aggr;
;
2.321928
0
0
NULL
2.321928

;
CREATE TABLE entr (l INTEGER[]);

;
INSERT INTO entr SELECT LIST(2) FROM range(100) tbl(i);

;
SELECT list_entropy(l) FROM entr;
;
0

;
create table aggr2 (k int[]);

;
INSERT INTO aggr2 VALUES ([0, 4, 0, 2, 2, 4, 4, 2, 4, 0, 0, 0, 2, 4, 2]);

;
INSERT INTO aggr2 VALUES ([1, 1, 1, 3, 3, 1, 3, 3, 3, 1]);

;
select list_entropy(k) from aggr2
;
1.584963
1.000000

;
create table names (name string[])

;
insert into names values (['pedro', 'pedro', 'pedro', 'hannes', 'hannes', 'mark', null]);

;
select list_entropy(name) from names;
;
1.459148