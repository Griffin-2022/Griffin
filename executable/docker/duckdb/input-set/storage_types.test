# name: test/sql/storage/storage_types.test
# description: Test storage of columns with various types
# group: [storage]

# load the DB from disk
load __TEST_DIR__/storage_types.db

foreach type <numeric>

;
CREATE TABLE a_${type} AS SELECT range::${type} i FROM range(100)

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_${type}
;
0	99	100	100

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_${type} WHERE i=1
;
1	1	1	1

endloop

# interval
;
CREATE TABLE a_interval AS SELECT interval (range) year i FROM range(1,1001)

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_interval
;
1 year	1000 years	1000	1000

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_interval WHERE i=interval 1 year
;
1 year	1 year	1	1

# bool
;
CREATE TABLE a_bool AS SELECT range%2=0 i FROM range(1000)

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_bool
;
false	true	1000	1000

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_bool WHERE not i
;
false	false	500	500

restart

# restart and check all types again

foreach type <numeric>

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_${type}
;
0	99	100	100

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_${type} WHERE i=1
;
1	1	1	1

endloop

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_interval
;
1 year	1000 years	1000	1000

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_interval WHERE i=interval 1 year
;
1 year	1 year	1	1

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_bool
;
false	true	1000	1000

;
SELECT MIN(i), MAX(i), COUNT(*), COUNT(i) FROM a_bool WHERE not i
;
false	false	500	500