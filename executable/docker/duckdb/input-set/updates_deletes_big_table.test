# name: test/sql/storage/updates_deletes_big_table.test
# description: Test update/deletes on big table
# group: [storage]

# load the DB from disk
load __TEST_DIR__/updates_deletes_big_table.db

;
CREATE TABLE test (a INTEGER);

;
INSERT INTO test SELECT a FROM range(0, 1000) tbl1(a), repeat(0, 100) tbl2(b)

;
UPDATE test SET a=2000 WHERE a=1

;
DELETE FROM test WHERE a=2 OR a=17

;
SELECT SUM(a), COUNT(a) FROM test
;
50148000	99800

;
SELECT COUNT(a) FROM test WHERE a=0
;
100

;
SELECT COUNT(a) FROM test WHERE a=1
;
0

;
SELECT COUNT(a) FROM test WHERE a=2
;
0

;
SELECT COUNT(a) FROM test WHERE a=17
;
0

restart

;
SELECT SUM(a), COUNT(a) FROM test
;
50148000	99800

;
SELECT COUNT(a) FROM test WHERE a=0
;
100

;
SELECT COUNT(a) FROM test WHERE a=1
;
0

;
SELECT COUNT(a) FROM test WHERE a=2
;
0

;
SELECT COUNT(a) FROM test WHERE a=17
;
0
