# name: test/sql/types/hugeint/test_hugeint_null_value.test
# description: Test hugeint null value handling
# group: [hugeint]

;
PRAGMA enable_verification

;
SELECT NULL::HUGEINT
;
NULL

;
CREATE TABLE hugeints(id INTEGER, h HUGEINT)

;
INSERT INTO hugeints VALUES (1, NULL), (1, 1), (1, 2)

;
SELECT id, FIRST(h), LAST(h) FROM hugeints WHERE h IS NULL GROUP BY id
;
1	NULL	NULL

;
SELECT h, SUM(id) FROM hugeints GROUP BY h ORDER BY 1
;
NULL	1
1	1
2	1

;
SELECT id, h1.h, h2.h FROM hugeints h1 JOIN hugeints h2 USING (id) WHERE h1.h IS NULL AND h2.h IS NULL
;
1	NULL	NULL

;
SELECT (SELECT h1.h) FROM hugeints h1 ORDER BY 1
;
NULL
1
2

;
SELECT h1.h NOT IN (SELECT h1.h+h2.h FROM hugeints h2) FROM hugeints h1 ORDER BY 1
;
NULL
NULL
NULL
