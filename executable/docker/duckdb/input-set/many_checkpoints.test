# name: test/sql/storage/many_checkpoints.test
# description: Test many checkpoints
# group: [storage]

# load the DB from disk
load __TEST_DIR__/many_checkpoints.db

;
CREATE TABLE test (a INTEGER PRIMARY KEY, b INTEGER, c VARCHAR);

;
CHECKPOINT

;
DROP TABLE test;

;
CHECKPOINT

;
CREATE TABLE test (a INTEGER PRIMARY KEY, b INTEGER, c VARCHAR);

;
CHECKPOINT

;
SELECT COUNT(*) FROM test
;
0

;
INSERT INTO test VALUES (11, 22, 'hello'), (13, 22, 'world'), (12, 21, 'test'), (10, NULL, NULL);

;
SELECT COUNT(*) FROM test
;
4

;
CHECKPOINT

;
SELECT COUNT(*) FROM test
;
4

;
INSERT INTO test VALUES (11, 22, 'hello');

;
CHECKPOINT

;
SELECT COUNT(*) FROM test
;
4

restart

;
SELECT COUNT(*) FROM test
;
4

;
SELECT * FROM test ORDER BY 1, 2, 3
;
10	NULL	NULL
11	22	hello
12	21	test
13	22	world
