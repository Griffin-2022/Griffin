# name: test/sql/index/art/test_art_sel_vector.test
# description: Test ART index with selection vector
# group: [art]

;
CREATE TABLE source(i INTEGER)

;
INSERT INTO source VALUES (1), (2), (3), (4), (5), (6)

;
CREATE TABLE integers(i INTEGER)

;
CREATE INDEX i_index ON integers using art(i)

# insert with selection vector
;
INSERT INTO integers SELECT * FROM source WHERE i % 2 = 0

;
SELECT * FROM integers WHERE i<3 ORDER BY 1
;
2

;
SELECT * FROM integers ORDER BY 1
;
2
4
6

;
SELECT * FROM integers WHERE i>3 ORDER BY 1
;
4
6

;
SELECT * FROM integers WHERE i<=3 ORDER BY 1
;
2

;
SELECT * FROM integers WHERE i>=3 ORDER BY 1
;
4
6

# update with selection vector
;
UPDATE integers SET i=3 WHERE i=4

;
SELECT * FROM integers WHERE i<3 ORDER BY 1
;
2

;
SELECT * FROM integers WHERE i<=3 ORDER BY 1
;
2
3

;
SELECT * FROM integers WHERE i>3 ORDER BY 1
;
6

;
SELECT * FROM integers WHERE i>=3 ORDER BY 1
;
3
6

# delete with selection vector
;
DELETE FROM integers WHERE i>3

;
SELECT * FROM integers WHERE i > 0 ORDER BY 1
;
2
3

;
SELECT * FROM integers WHERE i < 3 ORDER BY 1
;
2

