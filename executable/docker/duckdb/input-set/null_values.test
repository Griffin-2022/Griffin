# name: test/sql/insert/null_values.test
# description: Test inserting many null values
# group: [insert]

;
CREATE TABLE integers(i INTEGER)

;
INSERT INTO integers SELECT i FROM range(100) tbl(i);

;
BEGIN TRANSACTION

loop i 0 5

;
INSERT INTO integers SELECT i FROM range(100) tbl(i);

;
INSERT INTO integers SELECT NULL FROM range(100) tbl(i);

endloop

;
SELECT COUNT(i), SUM(i), MIN(i), MAX(i), COUNT(*) FROM integers
;
600	29700	0	99	1100

;
COMMIT

;
SELECT COUNT(i), SUM(i), MIN(i), MAX(i), COUNT(*) FROM integers
;
600	29700	0	99	1100

;
SELECT SUM(CASE WHEN i IS NULL THEN 1 ELSE 0 END) FROM integers
;
500