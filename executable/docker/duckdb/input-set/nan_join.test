# name: test/sql/types/float/nan_join.test
# description: Test NaN and inf joins
# group: [float]

;
PRAGMA enable_verification

# test various types of joins on nan and inf values
foreach type FLOAT DOUBLE

;
create table floats(f ${type});

;
insert into floats values ('inf'), ('-inf'), ('nan');

;
SELECT * FROM floats JOIN (SELECT 'inf'::${type}) tbl(f) USING (f)
;
inf

;
SELECT * FROM floats JOIN (SELECT '-inf'::${type}) tbl(f) USING (f)
;
-inf

;
SELECT * FROM floats JOIN (SELECT 'inf'::${type}) tbl(f) ON (floats.f >= tbl.f) ORDER BY 1
;
inf	inf
nan	inf

;
SELECT * FROM floats JOIN (SELECT 'inf'::${type}) tbl(f) ON (floats.f <= tbl.f) ORDER BY 1
;
-inf	inf
inf	inf

;
SELECT * FROM floats JOIN (SELECT '-inf'::${type}, 'inf'::${type}) tbl(f,g ) ON (floats.f >= tbl.f AND floats.f <= tbl.g) ORDER BY 1
;
-inf	-inf	inf
inf	-inf	inf

;
DROP TABLE floats

endloop
