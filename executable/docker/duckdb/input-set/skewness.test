# name: test/sql/function/list/aggregates/skewness.test
# description: Test the list_skewness aggregate function
# group: [aggregates]

# incorrect usage
;
select list_skewness()

;
select list_skewness([1])
;
NULL

;
CREATE TABLE skew AS SELECT LIST(10) AS i FROM range(5) t1(i)

# constant value
;
select list_skewness (i) from skew
;
NULL

# out of range
;
select list_skewness([-2e307, 0, 2e307])

;
create table aggr(k int[], v decimal(10,2)[], v2 decimal(10, 2)[]);

;
insert into aggr values ([1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	[10, 10, 10, 10, 20, 20, 25, 30, 30, 30, 30],
	[NULL, 11, 15, 18, 22, 25, NULL, 35, 40, 50, 51]),
	([], NULL, [NULL]);

;
select list_skewness(k), list_skewness(v), list_skewness(v2) from aggr
;
-3.316625	-0.163444	0.365401
NULL	NULL	NULL

;
create table aggr2(v2 decimal(10, 2)[]);

;
insert into aggr2 values ([NULL, 11, 15, 18]), ([22, 25]), ([NULL]), ([35, 40, 50, 51]);

;
select list_skewness(v2) from aggr2
;
-0.423273
NULL
NULL
-0.330141