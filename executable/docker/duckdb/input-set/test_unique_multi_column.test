# name: test/sql/constraints/unique/test_unique_multi_column.test
# description: NULL values and a multi-column UNIQUE constraint
# group: [unique]

;
CREATE TEMPORARY TABLE integers(i INTEGER, j INTEGER)

;
CREATE UNIQUE INDEX uidx ON integers (i,j)

;
INSERT INTO integers VALUES (3, 4), (2, 5)

;
SELECT * FROM integers
;
3	4
2	5

# insert a duplicate value as part of a chain of values, this should fail
;
INSERT INTO integers VALUES (6, 6), (3, 4);

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 6), (NULL, 7)

;
UPDATE integers SET i=77 WHERE i IS NULL

;
SELECT * FROM integers ORDER BY i, j
;
NULL	6
NULL	6
NULL	7
2	5
3	4

;
UPDATE integers SET i=77 WHERE i IS NULL AND j=7

;
SELECT * FROM integers ORDER BY i, j
;
NULL	6
NULL	6
2	5
3	4
77	7

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES (NULL, 6), (NULL, 7)

;
INSERT INTO integers VALUES  (3, 4)

;
DROP TABLE integers

