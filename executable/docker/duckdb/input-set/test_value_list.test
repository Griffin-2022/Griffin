# name: test/sql/projection/test_value_list.test
# description: Test value list in selection
# group: [projection]

;
PRAGMA enable_verification

# value list can be a top-level statement
;
(VALUES (1, 3), (2, 4));
;
1	3
2	4

# nulls first and then integers
;
SELECT * FROM (VALUES (NULL, NULL), (3, 4), (3, 7)) v1;
;
NULL	NULL
3	4
3	7

# standard value list
;
SELECT * FROM (VALUES (1, 2, 3), (1, 2, 3)) v1;
;
1	2	3
1	2	3

# value list with expressions
;
SELECT * FROM (VALUES (1 + 1, 2, 3), (1 + 3, 2, 3)) v1;
;
2	2	3
4	2	3

# value list with subqueries
;
SELECT * FROM (VALUES ((SELECT 42), 2, 3), (1 + 3,2,3)) v1;
;
42	2	3
4	2	3

# value list in insert
;
CREATE TABLE test (a INTEGER, b INTEGER);

;
INSERT INTO test VALUES (1, 2), (3, 4);

# value list with more complicated subqueries
;
SELECT * FROM (VALUES ((SELECT MIN(a) FROM test), 2, 3), ((SELECT MAX(b) FROM test), 2, 3)) v1;
;
1	2	3
4	2	3

# value list with different types
;
SELECT * FROM (VALUES ('hello', 2), (1 + 3, '5'), (DATE '1992-09-20', 3)) v1;
;
hello	2
4	5
1992-09-20	3

# value list with NULLs
;
SELECT * FROM (VALUES (DATE '1992-09-20', 3), (NULL, NULL)) v1;
;
1992-09-20	3
NULL	NULL

# only NULLs
;
SELECT * FROM (VALUES (NULL, NULL)) v1;
;
NULL	NULL

# nulls first and then integers
;
SELECT * FROM (VALUES (NULL, NULL), (3, 4)) v1;
;
NULL	NULL
3	4

# type is the max type of all input columns
;
SELECT * FROM (VALUES (3), ('hello')) v1;
;
3
hello

;
SELECT * FROM (VALUES (NULL), ('hello')) v1;
;
NULL
hello

# unbalanced value list is not allowed
;
SELECT * FROM (VALUES (1, 2, 3), (1,2)) v1;

# default in value list is not allowed
;
SELECT * FROM (VALUES (DEFAULT, 2, 3), (1,2)) v1;

# VALUES list for INSERT
;
CREATE TABLE varchars(v VARCHAR);

;
INSERT INTO varchars VALUES (1), ('hello'), (DEFAULT);

;
SELECT * FROM varchars ORDER BY 1
;
NULL
1
hello

# too many columns provided
;
INSERT INTO varchars VALUES (1, 2), ('hello', 3), (DEFAULT, DEFAULT);

;
INSERT INTO varchars (v) VALUES (1, 2), ('hello', 3), (DEFAULT, DEFAULT);

;
INSERT INTO varchars (v) VALUES (1, 2), ('hello'), (DEFAULT, DEFAULT);

# operation on default not allowed
;
INSERT INTO varchars (v) VALUES (DEFAULT IS NULL);

