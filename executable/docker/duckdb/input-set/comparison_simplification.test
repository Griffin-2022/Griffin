# name: test/optimizer/comparison_simplification.test
# description: Comparison simplification test
# group: [optimizer]

;
CREATE TABLE test(X INTEGER);

;
PRAGMA explain_output = OPTIMIZED_ONLY;

# comparisons with NULL result in NULL
;
EXPLAIN SELECT NULL FROM test
;

;
EXPLAIN SELECT X=NULL FROM test
;

;
EXPLAIN SELECT X>NULL FROM test
;

;
EXPLAIN SELECT NULL>X FROM test
;

# in the WHERE clause this gets pruned entirely
;
EXPLAIN SELECT * FROM test WHERE 1=0
;

;
EXPLAIN SELECT * FROM test WHERE X=NULL
;

# we shift casts from columns to columns when possible
;
EXPLAIN SELECT X=1::BIGINT FROM test
;

;
EXPLAIN SELECT X::BIGINT=1::INTEGER FROM test
;

;
EXPLAIN SELECT X='1' FROM test
;

;
EXPLAIN SELECT X::BIGINT='1' FROM test
;
