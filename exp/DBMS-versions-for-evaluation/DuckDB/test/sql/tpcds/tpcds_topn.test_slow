# name: test/sql/tpcds/tpcds_topn.test_slow
# description: Test top-n queries on TPC-DS
# group: [tpcds]

require tpcds

statement ok
PRAGMA enable_verification

statement ok
CALL dsdgen(sf=1);

query IIIIIIIIIIIIIIIIII
SELECT * FROM customer ORDER BY c_customer_sk DESC, c_customer_id DESC LIMIT 5;
----
100000	AAAAAAAAAKGIBAAA	441077	4582	8487	2449763	2449733	Mrs.	Erica	Parrott	N	16	7	1939	BELGIUM	(empty)	Erica.Parrott@9pnE.com	2452621
99999	AAAAAAAAPJGIBAAA	1641963	292	15421	2452000	2451970	Mr.	Rex	Reyes	Y	9	7	1981	GREECE	(empty)	Rex.Reyes@saLGsYab.org	2452297
99998	AAAAAAAAOJGIBAAA	1030893	4338	46583	2452285	2452255	Dr.	Helen	Bateman	N	8	11	1979	UNITED KINGDOM	(empty)	Helen.Bateman@bVJ4ND7frLIIJZX.org	2452541
99997	AAAAAAAANJGIBAAA	1822151	6135	2919	2450290	2450260	Dr.	Jennifer	Bolton	Y	9	4	1954	BRUNEI DARUSSALAM	(empty)	Jennifer.Bolton@ecidoI.com	2452497
99996	AAAAAAAAMJGIBAAA	1106140	769	29398	2451524	2451494	Dr.	Larry	Kerr	Y	20	9	1959	LITHUANIA	(empty)	Larry.Kerr@V6KToJQKDF4a.org	2452300

query IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
SELECT * FROM web_sales ORDER BY ws_sold_date_sk DESC, ws_sold_time_sk, ws_ship_date_sk DESC LIMIT 5;
----
2452642	150	2452754	5448	54282	327982	6835	10135	64413	768001	731	18708	49	21	17	3	209	21442	76	0.73	1.98	1.76	16.61	134.39	55.72	151.00	9.40	0.00	69.45	134.39	143.79	203.84	213.25	78.66
2452642	150	2452749	12234	54282	327982	6835	10135	64413	768001	731	18708	49	30	18	3	151	21442	54	0.34	0.42	0.00	22.71	0.45	18.53	23.17	0.02	0.00	6.48	0.45	0.48	6.94	6.96	-18.07
2452642	150	2452739	10692	54282	327982	6835	10135	64413	768001	731	18708	1	15	2	4	36	21442	97	0.23	0.69	0.14	53.02	14.09	22.75	67.12	0.00	0.00	24.83	14.09	14.09	38.92	38.92	-8.66
2452642	150	2452733	13719	54282	327982	6835	10135	64413	768001	731	18708	49	21	17	3	269	21442	17	0.54	0.77	0.34	7.20	5.89	9.28	13.09	0.17	0.00	1.70	5.89	6.06	7.59	7.77	-3.39
2452642	150	2452730	11448	54282	327982	6835	10135	64413	768001	731	18708	43	21	10	4	8	21442	79	0.77	1.21	0.02	94.02	1.91	61.50	95.93	0.15	0.00	35.49	1.91	2.06	37.40	37.55	-59.58

query IIIIIIIIIIIIIIIIIIIIIII
SELECT * FROM store_sales ORDER BY ss_wholesale_cost DESC, ss_list_price DESC, ss_sales_price DESC LIMIT 5;
----
2450961	41243	14224	43635	774719	4650	48934	10	111	81403	58	1.00	2.00	1.30	0.00	75.40	58.00	116.00	6.78	0.00	75.40	82.18	17.40
2451477	43650	8584	53438	890670	3902	7934	2	98	228380	26	1.00	1.99	1.91	0.00	49.67	26.00	51.74	2.48	0.00	49.67	52.15	23.67
2451825	51234	7699	96888	1847791	7047	49903	2	224	56735	66	1.00	1.99	1.27	0.00	84.05	66.00	131.34	1.68	0.00	84.05	85.73	18.05
2452228	32676	17493	66423	493260	2497	18887	2	63	112168	90	1.00	1.99	1.17	0.00	105.66	90.00	179.10	6.34	0.00	105.66	112.00	15.66
2452366	54008	11371	66649	1175495	5141	10387	4	233	145999	47	1.00	1.99	1.11	19.37	52.37	47.00	93.53	1.97	19.37	32.99	34.97	-14.00
