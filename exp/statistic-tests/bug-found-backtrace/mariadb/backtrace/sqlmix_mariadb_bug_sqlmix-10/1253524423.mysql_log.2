DECLARE CURSOR fk IS
SELECT ID FROM SYS_FOREIGN
WHERE FOR_NAME=:name
AND TO_BINARY(FOR_NAME)=TO_BINARY(:name)
FOR UPDATE;
BEGIN
OPEN fk;
WHILE 1=1 LOOP
  FETCH fk INTO fid;
  IF (SQL % NOTFOUND)THEN RETURN;END IF;
  DELETE FROM SYS_FOREIGN_COLS WHERE ID=fid;
  DELETE FROM SYS_FOREIGN WHERE ID=fid;
END LOOP;
CLOSE fk;
END;

dict_table_open_on_name: dict_table_open_on_name: table: 'SYS_FOREIGN'
dict_table_open_on_name: dict_table_open_on_name: table: 'SYS_FOREIGN_COLS'
dict_table_open_on_name: dict_table_open_on_name: table: 'SYS_FOREIGN'
que_eval_sql: ib_que: Execute 9 (QUERY THREAD) at 0x629003055000
que_eval_sql: ib_que: Execute 1044 (STORED PROCEDURE) at 0x6290030550a8
que_eval_sql: ib_que: Execute 25 (OPEN) at 0x629003053518
que_eval_sql: ib_que: Execute 1044 (STORED PROCEDURE) at 0x6290030550a8
que_eval_sql: ib_que: Execute 1046 (WHILE) at 0x629003054db8
que_eval_sql: ib_que: Execute 24 (FETCH) at 0x6290030539a0
que_eval_sql: ib_que: Execute 6 (SELECT) at 0x629003052868
btr_cur_search_to_nth_level: mutex: mutex (0x69a4520) locking
btr_cur_search_to_nth_level: mutex: mutex (0x69a4520) locked
btr_cur_search_to_nth_level: mutex: mutex (0x69a4520) unlocking
que_eval_sql: ib_que: Execute 24 (FETCH) at 0x6290030539a0
que_eval_sql: ib_que: Execute 1046 (WHILE) at 0x629003054db8
que_eval_sql: ib_que: Execute 1045 (IF) at 0x629003053ba0
que_eval_sql: ib_que: Execute 28 (RETURN) at 0x629003053b60
que_eval_sql: ib_que: Execute 9 (QUERY THREAD) at 0x629003055000
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003052868, type: 6
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003054f48, type: 8
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003055000, type: 9
que_graph_free_recursive: que_graph_free_recursive: node: 0x6290030550a8, type: 1044
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003053518, type: 25
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003054db8, type: 1046
que_graph_free_recursive: que_graph_free_recursive: node: 0x6290030539a0, type: 24
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003053ba0, type: 1045
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003053b60, type: 28
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003053d00, type: 4
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003054088, type: 6
que_graph_free_recursive: que_graph_free_recursive: node: 0x6290030545d8, type: 4
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003054960, type: 6
que_graph_free_recursive: que_graph_free_recursive: node: 0x629003054ef8, type: 25
print_buffer_to_file: enter: buffer: InnoDB: Column stat_description in table mysql.innodb_index_stats is VARCHAR(3072) but should be VARCHAR(3072) NOT NULL
print_buffer_to_file: mutex: LOCK_error_log (0x600d7e0) locking
print_buffer_to_file: mutex: LOCK_error_log (0x600d7e0) locked
2022-08-06  9:18:26 4 [ERROR] InnoDB: Column stat_description in table mysql.innodb_index_stats is VARCHAR(3072) but should be VARCHAR(3072) NOT NULL
print_buffer_to_file: mutex: LOCK_error_log (0x600d7e0) unlocking
print_buffer_to_file: enter: buffer: InnoDB: Column stat_description in table mysql.innodb_index_stats is VARCHAR(3072) but should be VARCHAR(3072) NOT NULL
print_buffer_to_file: mutex: LOCK_error_log (0x600d7e0) locking
print_buffer_to_file: mutex: LOCK_error_log (0x600d7e0) locked
2022-08-06  9:18:26 4 [ERROR] InnoDB: Column stat_description in table mysql.innodb_index_stats is VARCHAR(3072) but should be VARCHAR(3072) NOT NULL
print_buffer_to_file: mutex: LOCK_error_log (0x600d7e0) unlocking
que_eval_sql: que_eval_sql: query: PROCEDURE DROP_VIRTUAL() IS
BEGIN
DELETE FROM SYS_VIRTUAL WHERE TABLE_ID=:id;
END;

dict_table_open_on_name: dict_table_open_on_name: table: 'SYS_VIRTUAL'
que_eval_sql: ib_que: Execute 9 (QUERY THREAD) at 0x629001bade08
que_eval_sql: ib_que: Execute 1044 (STORED PROCEDURE) at 0x629001badeb0
que_eval_sql: ib_que: Execute 4 (UPDATE) at 0x629001bad578
que_eval_sql: ib_que: Execute 6 (SELECT) at 0x629001bad8f8
btr_cur_search_to_nth_level: mutex: mutex (0x69a4520) locking
btr_cur_search_to_nth_level: mutex: mutex (0x69a4520) locked
btr_cur_search_to_nth_level: mutex: mutex (0x69a4520) unlocking
que_eval_sql: ib_que: Execute 4 (UPDATE) at 0x629001bad578
que_eval_sql: ib_que: Execute 1044 (STORED PROCEDURE) at 0x629001badeb0
que_eval_sql: ib_que: Execute 9 (QUERY THREAD) at 0x629001bade08
que_graph_free_recursive: que_graph_free_recursive: node: 0x629001badd50, type: 8
que_graph_free_recursive: que_graph_free_recursive: node: 0x629001bade08, type: 9
que_graph_free_recursive: que_graph_free_recursive: node: 0x629001badeb0, type: 1044
que_graph_free_recursive: que_graph_free_recursive: node: 0x629001bad578, type: 4
que_graph_free_recursive: que_graph_free_recursive: node: 0x629001bad8f8, type: 6
que_eval_sql: que_eval_sql: query: PROCEDURE DROP_TABLE() IS
iid CHAR;
DECLARE CURSOR idx IS
SELECT ID FROM SYS_INDEXES
WHERE TABLE_ID=:id FOR UPDATE;
BEGIN
DELETE FROM SYS_TABLES WHERE ID=:id;
DELETE FROM SYS_COLUMNS WHERE TABLE_ID=:id;
OPEN idx;
WHILE 1 = 1 LOOP
  FETCH idx INTO iid;
  IF (SQL % NOTFOUND) THEN EXIT; END IF;
  DELETE FROM SYS_INDEXES WHERE CURRENT OF idx;
  DELETE FROM SYS_FIELDS WHERE INDEX_ID=iid;
END LOOP;
CLOSE idx;
END;

dict_table_open_on_name: dict_table_open_on_name: table: 'SYS_INDEXES'
dict_table_open_on_name: dict_table_open_on_name: table: 'SYS_TABLES'
dict_table_open_on_name: dict_table_open_on_name: table: 'SYS_COLUMNS'
